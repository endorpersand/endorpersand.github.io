{"mappings":"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","sources":["src/snake/snake.ts","node_modules/.pnpm/@parcel+transformer-js@2.6.2_@parcel+core@2.6.2/node_modules/@parcel/transformer-js/src/esmodule-helpers.js"],"sourcesContent":["const canvas = document.querySelector('#canvas')! as HTMLCanvasElement;\nconst ctx = canvas.getContext('2d')!;\n\nlet s = 25; // 1 game pixel = s canvas pixels\n\ntype GameCoord = [number, number];\ntype CanvasCoord = [number, number];\nlet [gMaxWidth, gMaxHeight] = toG([canvas.width, canvas.height]);\nlet snake: GameCoord[] = [[Math.floor(gMaxWidth / 4), Math.floor(gMaxHeight / 2)]]; // [head, ..., tail]\nlet facing = 'e'; //n, e, s, w\n\nlet apple: GameCoord;\n\n// CONFIG //\nconst pal = { // color palette\n    bg: '#222',\n    snake: '#0b0',\n    apple: '#d00',\n    death: '#fff',\n}\nsnake.length = 5; // initial snake length\nconst tpu = 75; // ticks per update\n\n\ndrawGRect([0,0], canvas.width, canvas.height, pal.bg, [0, 0]); // draw bg\ndrawGRect(snake[0], s - 2, s - 2, pal.snake); // draw snake\ndrawApple();\nlet int: NodeJS.Timer | undefined = setInterval(update, tpu);\n\ndocument.onkeydown = e => {\n    switch (e.code) {\n        case 'KeyW':\n        case 'ArrowUp':\n            if (facing != 's' && facing != 'n') {\n                facing = 'n';\n                update();\n            }\n            break;\n        case 'KeyA':\n        case 'ArrowLeft':\n            if (facing != 'e' && facing != 'w') {\n                facing = 'w';\n                update();\n            }\n            break;\n        case 'KeyS':\n        case 'ArrowDown':\n            if (facing != 's' && facing != 'n') {\n                facing = 's';\n                update();\n            }\n            break;\n        case 'KeyD':\n        case 'ArrowRight':\n            if (facing != 'e' && facing != 'w') {\n                facing = 'e';\n                update();\n            }\n            break;\n        case 'KeyR':\n            die()\n            break;\n    }\n};\n\ndocument.onblur = () => {\n    clearInterval(int);\n    int = undefined;\n}\n\ndocument.onfocus = () => {\n    int = int || setInterval(update, tpu);\n}\nfunction drawGRect(g: GameCoord, cw: number, ch: number, color: string, cshift = [1,1]) {\n    let c = toC(g).map((x, i) => x + cshift[i]) as CanvasCoord; // conv g coord and then shift point in c space\n    ctx.fillStyle = color;\n    ctx.fillRect(...c, cw, ch);\n}\n\nfunction drawSnakeSeg(g: GameCoord) {\n    /*\n     * if s = 4,\n     * ........\n     * .xx..xx.\n     * .xx..xx.\n     * ........\n     * o.......\n     * .xx..xx.\n     * .xx..xx.\n     * ........\n     *\n     *\n     *\n     */\n    switch (facing) {\n        case 'n':\n            drawGRect(g, s-2, s, pal.snake)//, [1, 1]);\n            break;    \n        case 'e':\n            drawGRect(g, s, s-2, pal.snake, [-1, 1])//, [-1, 1]);\n            break;\n        case 's':\n            drawGRect(g, s-2, s, pal.snake, [1, -1])//, [1, -1]);\n            break;\n        case 'w':\n            drawGRect(g, s, s-2, pal.snake)//, [1, 1]);\n            break;\n    }\n}\n\nfunction drawApple() {\n    do {\n        apple = [Math.floor(Math.random() * gMaxWidth), Math.floor(Math.random() * gMaxHeight)];\n    } while (snake.some(x => arrEq(x, apple)))\n    drawGRect(apple, s - 2, s - 2, pal.apple); // spawn apple\n}\n\nfunction update() {\n    let nextPos: GameCoord = [...snake[0]]; //clone head\n    switch (facing) {\n        case 'n':\n            nextPos[1]--;\n            break;\n        case 'e':\n            nextPos[0]++;\n            break;\n        case 's':\n            nextPos[1]++;\n            break;\n        case 'w':\n            nextPos[0]--;\n            break;\n    }\n    if(!arrEq(apple, nextPos)) {\n        // if next pos is not apple, delete tail\n        let stail = snake.pop()!;\n        drawGRect(stail, s + 2, s + 2, pal.bg, [-1, -1]);\n    }\n    if(arrEq(apple, nextPos)) drawApple(); // if next pos is apple, spawn a new apple\n    if(arrIncludes(snake, nextPos)) die(); // if next pos is snake, die\n    if (isOutBound(nextPos)) die(); // if next pos is void, die\n    //console.log(nextColor, appleData);\n    snake.unshift(nextPos);\n    drawSnakeSeg(nextPos);\n    document.querySelector('#score')!.textContent = `Score: ${snake.length}`;\n}\n\nfunction die() {\n    clearInterval(int);\n    ctx.fillStyle = pal.death;\n    ctx.font = `${canvas.width * 250 / 700}px 'Comic Sans MS', 'Papyrus', 'Impact', fantasy, cursive, sans-serif`;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillText('F', canvas.width / 2, canvas.height / 2);\n\n    document.onkeydown = e => e.key == 'r' ? location.reload() : void 0;\n    document.onfocus = null;\n\n    let button = document.createElement('button');\n    button.textContent = 'Restart';\n    button.onclick = () => location.reload();\n    document.querySelector('#score')?.parentElement?.appendChild(button);\n}\n\nfunction toC(g: GameCoord | undefined): CanvasCoord {\n    // converts a game coord to canvas coord\n    return (g ?? [0, 0]).map(x => x * s) as CanvasCoord;\n}\nfunction toG(c: CanvasCoord | undefined): GameCoord {\n    // converts a canvas coord to game coord\n    return (c ?? [0, 0]).map(x => x / s) as GameCoord;\n}\nfunction isOutBound(g: GameCoord) {\n    // game bounds [0, gMaxWidth), [0, gMaxHeight)\n    return g[0] < 0 || g[0] >= gMaxWidth || g[1] < 0 || g[1] >= gMaxHeight;\n}\n\nfunction arrEq<T>(a1: T[], a2: T[]) {\n    return a1.every((x, i) => x == a2[i]);\n}\nfunction arrIncludes<T>(metarr: T[][], arr: T[]) {\n    return metarr.some(a => arrEq(a, arr));\n}\nexport {}","exports.interopDefault = function (a) {\n  return a && a.__esModule ? a : {default: a};\n};\n\nexports.defineInteropFlag = function (a) {\n  Object.defineProperty(a, '__esModule', {value: true});\n};\n\nexports.exportAll = function (source, dest) {\n  Object.keys(source).forEach(function (key) {\n    if (key === 'default' || key === '__esModule' || dest.hasOwnProperty(key)) {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function () {\n        return source[key];\n      },\n    });\n  });\n\n  return dest;\n};\n\nexports.export = function (dest, destName, get) {\n  Object.defineProperty(dest, destName, {\n    enumerable: true,\n    get: get,\n  });\n};\n"],"names":[],"version":3,"file":"snake.baef0600.js.map","sourceRoot":"/__parcel_source_root/"}