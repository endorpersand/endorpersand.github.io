{"mappings":"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","sources":["node_modules/.pnpm/@parcel+runtime-js@2.5.0_@parcel+core@2.5.0/node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/.pnpm/@parcel+runtime-js@2.5.0_@parcel+core@2.5.0/node_modules/@parcel/runtime-js/lib/runtime-dcca6fd6479f29d7.js","src/complexgrapher/complexgrapher.ts","node_modules/.pnpm/@parcel+runtime-js@2.5.0_@parcel+core@2.5.0/node_modules/@parcel/runtime-js/lib/helpers/get-worker-url.js","node_modules/.pnpm/@parcel+runtime-js@2.5.0_@parcel+core@2.5.0/node_modules/@parcel/runtime-js/lib/runtime-d76853abe3dd4514.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"fujT7\\\":\\\"complexgrapher.d9f975c1.js\\\",\\\"egthy\\\":\\\"main.9b0566a7.js\\\",\\\"2KAe5\\\":\\\"complexgrapher.960d1ae9.js\\\"}\"));","import { create, all } from \"mathjs\";\nimport { Complex, ComplexFunction, MainIn, MainOut, PartialEvaluator } from \"./types\";\nconst math = create(all);\n\nconst canvas      = document.querySelector('canvas')!       as HTMLCanvasElement,\n      funcForm    = document.querySelector('#funcForm')!    as HTMLFormElement,\n      input       = funcForm.querySelector('input')!        as HTMLInputElement,\n      graphButton = document.querySelector('#graphButton')! as HTMLButtonElement,\n      zcoord      = document.querySelector('#zcoord')!      as HTMLDivElement,\n      zoomButtons = document.querySelectorAll('button.zoom'),\n      zoomForm    = document.querySelector('#zoomForm')!    as HTMLFormElement,\n      zoomInput   = zoomForm.querySelector('input')!        as HTMLInputElement,\n      scaleForm   = document.querySelector('#scaleForm')!   as HTMLFormElement,\n      scaleInput  = scaleForm.querySelector('input')!       as HTMLInputElement,\n      warning     = document.querySelector('#warning')!     as HTMLDivElement,\n      domain      = document.querySelectorAll('.domain');\nconst ctx = canvas.getContext('2d', {alpha: false})!;\nlet scale = 1; // increase = zoom in, decrease = zoom out\nlet d: ComplexFunction = (z => z); // actual values of the function\n\nlet worker: Worker = new Worker(new URL(\"./worker/main\", import.meta.url), {type: \"module\"});\nworker.onmessage = function (e) {\n    let msg: MainOut = e.data;\n\n    if (msg.action === \"loadChunk\") {\n        let dat = new ImageData(new Uint8ClampedArray(msg.buf), msg.chunk.width, msg.chunk.height);\n        ctx.putImageData(dat, msg.chunk.offx, msg.chunk.offy);\n    } else if (msg.action === \"done\") {\n        markDone(msg.time);\n    }\n}\nworker.onerror = onComputeError;\n\nvar domaind = [math.complex('-2-2i'), math.complex('2+2i')] as [unknown, unknown] as [Complex, Complex];\n\nfunction canvasHover(e: MouseEvent) {\n    zcoord.classList.remove('error');\n    zcoord.textContent = `z = ${convPlanes(e.pageX - canvas.offsetLeft, e.pageY - canvas.offsetTop)}`;\n};\n\ncanvas.addEventListener('mousemove', canvasHover);\ncanvas.addEventListener('click', e => {\n    let cx = e.pageX - canvas.offsetLeft;\n    let cy = e.pageY - canvas.offsetTop;\n\n    let z = convPlanes(cx, cy);\n    console.log(`z = ${z},\\nf(z) = ${d(z)}`);\n})\ninput.addEventListener('input', () => {\n    input.value = input.value.replace(/[^a-zA-Z0-9+\\-*/^., ()]/g, ''); //removes invalid characters\n})\ngraphButton.addEventListener('click', () => {\n    zcoord.classList.remove('error');\n    zoomInput.value = scale.toString();\n\n    let size = +scaleInput.value * 2 + 1;\n    if (canvas.width !== size) canvas.width = canvas.height = size;\n    [domain[0].textContent, domain[1].textContent] = domaind.map(x => x.div(scale).toString());\n    zcoord.textContent = 'Graphing...'\n    canvas.removeEventListener('mousemove', canvasHover);\n\n    let fstr = input.value;\n    try {\n        d = math.evaluate(`f(z) = ${fstr}`);\n        startWorker(worker, fstr);\n    } catch (e) {\n        onComputeError(e as any);\n        throw e;\n    }\n});\n\nzoomButtons[0].addEventListener('click', () => {\n    scale *= 2;\n    graphButton.click();\n})\nzoomButtons[1].addEventListener('click', () => {\n    if (scale !== 1) {\n        scale = 1;\n        graphButton.click();\n    }\n})\nzoomButtons[2].addEventListener('click', () => {\n    scale /= 2;\n    graphButton.click();\n})\nzoomInput.addEventListener('input', () => {\n    zoomInput.value = zoomInput.value.replace(/[^0-9.]/g, '');\n    if (isNaN(+scaleInput.value)) zoomInput.value = \"1\";\n\n    if ([...zoomInput.value].filter(x => x === '.').length > 1) {\n        var ziArray = zoomInput.value.split('.');\n        zoomInput.value = ziArray[0] + '.' + ziArray.slice(1).join('');\n    }\n});\nzoomForm.addEventListener('submit', e => {\n    e.preventDefault();\n    if (scale !== +zoomInput.value) {\n    scale = +zoomInput.value || 0;\n    graphButton.click();\n    }\n})\nscaleInput.addEventListener('input', () => {\n    if (isNaN(+scaleInput.value)) scaleInput.value = \"250\";\n    warning.style.display = +scaleInput.value > 250 ? 'inline' : 'none';\n});\nscaleForm.addEventListener('submit', e => {\n    e.preventDefault();\n    let size = +scaleInput.value * 2 + 1;\n    if (canvas.width !== size) {\n    canvas.width = canvas.height = size;\n    graphButton.click();\n    }\n})\nfuncForm.addEventListener('submit', e => {\n    e.preventDefault();\n    graphButton.click();\n})\n\nfunction convPlanes(x: number, y: number) {\n    //converts xy pixel plane to complex plane\n\n    // let cmx =  (row - rx) / (rx / 2) / scale,\n    //     cmy = -(col - ry) / (ry / 2) / scale;\n\n    // row - rx: distance from center, in canvas pixels\n    // / (rx / 2): normalizes that so the edge is 2\n    // / scale: scale mult.\n\n    let [rx, ry] = [(canvas.width - 1) / 2, (canvas.height - 1) / 2];\n    let cmx =  (x - rx) / (rx / 2) / scale,\n        cmy = -(y - ry) / (ry / 2) / scale;\n    return math.complex(cmx, cmy) as unknown as Complex;\n}\n\nfunction startWorker(w: Worker, fstr: string) {\n    let msg: MainIn = {\n        pev: partialEvaluate(fstr), \n        cd: {\n        width: canvas.width,\n        height: canvas.height,\n        scale\n    }};\n    w.postMessage(msg);\n}\n\nfunction partialEvaluate(fstr: string): PartialEvaluator {\n    let node = math.simplify(fstr);\n    let fnode = math.parse(\"f(z) = 0\") as math.FunctionAssignmentNode;\n\n    let inverse = false;\n    if (node.type == \"OperatorNode\" && node.fn == 'divide' && !isNaN(+node.args[0])) { // reciprocal func\n        node.args.reverse();\n        node = math.simplify(node);\n        inverse = true;\n    }\n\n    fnode.expr = node;\n    return { fstr: fnode.toString(), inverse };\n}\n\nfunction markDone(t: number) {\n    zcoord.textContent = `Done in ${t}ms.`;\n    reenableHover();\n}\n\nfunction onComputeError(e: Error | ErrorEvent) {\n    let err = e instanceof ErrorEvent ? e.message : e;\n\n    canvas.removeEventListener('mousemove', canvasHover);\n    zcoord.classList.add('error');\n    zcoord.textContent = String(err);\n    reenableHover();\n}\n\nfunction reenableHover() {\n    setTimeout(() => canvas.addEventListener('mousemove', canvasHover), 500);\n}\n\ngraphButton.click();\n","\"use strict\";\n\nmodule.exports = function (workerUrl, origin, isESM) {\n  if (origin === self.location.origin) {\n    // If the worker bundle's url is on the same origin as the document,\n    // use the worker bundle's own url.\n    return workerUrl;\n  } else {\n    // Otherwise, create a blob URL which loads the worker bundle with `importScripts`.\n    var source = isESM ? 'import ' + JSON.stringify(workerUrl) + ';' : 'importScripts(' + JSON.stringify(workerUrl) + ');';\n    return URL.createObjectURL(new Blob([source], {\n      type: 'application/javascript'\n    }));\n  }\n};","let workerURL = require('./helpers/get-worker-url');\nlet url = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"egthy\"));\nmodule.exports = workerURL(url.toString(), url.origin, true);"],"names":["$39a5f4b8f173247d$export$6503ec6e8aabbaf","$39a5f4b8f173247d$export$f7ad0328861e2f03","$39a5f4b8f173247d$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$jPsve","$7b066cf9bf825db5$var$math","create","all","$7b066cf9bf825db5$var$canvas","document","querySelector","$7b066cf9bf825db5$var$funcForm","$7b066cf9bf825db5$var$input","$7b066cf9bf825db5$var$graphButton","$7b066cf9bf825db5$var$zcoord","$7b066cf9bf825db5$var$zoomButtons","querySelectorAll","$7b066cf9bf825db5$var$zoomForm","$7b066cf9bf825db5$var$zoomInput","$7b066cf9bf825db5$var$scaleForm","$7b066cf9bf825db5$var$scaleInput","$7b066cf9bf825db5$var$warning","$7b066cf9bf825db5$var$domain","$7b066cf9bf825db5$var$ctx","getContext","alpha","$7b066cf9bf825db5$var$scale","$7b066cf9bf825db5$var$d","z","$ada7ce5685d1764f$exports","workerUrl","origin","isESM","self","location","source","stringify","URL","createObjectURL","Blob","type","$3c2ce725a9310354$var$url","resolve","import","meta","url","$3c2ce725a9310354$exports","toString","$7b066cf9bf825db5$var$worker","Worker","onmessage","e","msg","data","action","dat","ImageData","Uint8ClampedArray","buf","chunk","width","height","putImageData","offx","offy","t","time","textContent","$7b066cf9bf825db5$var$reenableHover","onerror","$7b066cf9bf825db5$var$onComputeError","$7b066cf9bf825db5$var$domaind","complex","$7b066cf9bf825db5$var$canvasHover","classList","remove","$7b066cf9bf825db5$var$convPlanes","pageX","offsetLeft","pageY","offsetTop","x","y","rx","ry","cmx","cmy","$7b066cf9bf825db5$var$partialEvaluate","fstr","node","simplify","fnode","inverse","fn","isNaN","args","reverse","expr","err","ErrorEvent","message","removeEventListener","add","String","setTimeout","addEventListener","console","log","value","replace","size","map","div","evaluate","w","pev","cd","postMessage","$7b066cf9bf825db5$var$startWorker","click","filter","ziArray","split","slice","join","preventDefault","style","display"],"version":3,"file":"complexgrapher.d9f975c1.js.map"}