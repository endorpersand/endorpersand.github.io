{"mappings":"6UAAA,SAASA,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQC,EAAKC,GACpE,IACE,IAAIC,EAAOP,EAAIK,GAAKC,GAChBE,EAAQD,EAAKC,MACjB,MAAOC,GAEP,YADAP,EAAOO,GAILF,EAAKG,KACPT,EAAQO,GAERG,QAAQV,QAAQO,GAAOI,KAAKT,EAAOC,GAIxB,SAAAS,EAA2BC,GACxC,OAAO,WACL,IAAIC,EAAOC,KACTC,EAAOC,UACT,OAAO,IAAIP,SAAQ,SAAUV,EAASC,GACpC,IAAIF,EAAMc,EAAGK,MAAMJ,EAAME,GAEzB,SAASd,EAAMK,GACbT,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,OAAQI,GAGlE,SAASJ,EAAOgB,GACdrB,EAAmBC,EAAKC,EAASC,EAAQC,EAAOC,EAAQ,QAASgB,GAGnEjB,OAAMkB,O,iVCTZ,IAAAC,EACAC,E,iJArBA,IAAIC,EAAU,GAoBdF,EAlBA,SAAkBG,GAGhB,IAFA,IAAIC,EAAOC,OAAOD,KAAKD,GAEdG,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAC/BJ,EAAQE,EAAKE,IAAMH,EAAMC,EAAKE,KAelCL,EAXA,SAAiBO,GACf,IAAIC,EAAWP,EAAQM,GAEvB,GAAgB,MAAZC,EACF,MAAM,IAAIC,MAAM,oCAAsCF,GAGxD,OAAOC,M,kCC2BT,IAAAE,EAEAC,E,uJA9CA,IAAIC,EAAY,GA6BhB,SAASC,EAAWC,GAClB,OAAQ,GAAKA,GAAKC,QAAO,0EAA4E,MAAQ,IAc/GL,EA1CA,SAA4BH,GAC1B,IAAItB,EAAQ2B,EAAUL,GAOtB,OALKtB,IACHA,EAOJ,WACE,IACE,MAAM,IAAIwB,MACV,MAAOZ,GACP,IAAImB,GAAW,GAAKnB,EAAIoB,OAAOC,MAAK,oEAEpC,GAAIF,EAGF,OAAOH,EAAWG,EAAQ,IAI9B,MAAO,IApBGG,GACRP,EAAUL,GAAMtB,GAGXA,GAoCT0B,EAZA,SAAmBG,GACjB,IAAIE,GAAW,GAAKF,GAAKI,MAAK,iEAE9B,IAAKF,EACH,MAAM,IAAIP,MAAM,oBAGlB,OAAOO,EAAQ,OC3CjBI,EAAA,SAAAC,SAA8CC,KAAKC,MAAM,wZ,wDCAzDC,EAAAJ,EAAA,SCAAK,G,WAAAL,EAAA,U,uCAKe,SAAAM,EAAkBC,GAC/B,OAAO,EAAAF,EAAAG,SAAeD,KAAQ,EAAAE,EAAAD,SAAgBD,KAAQ,EAAAG,EAAAF,SAA2BD,EAAKtB,KAAM,EAAA0B,EAAAH,W,8BC4DpFI,E,EAhEJC,GAAO,EAAAC,EAAAC,QAAOD,EAAAE,KAQdC,EAAY,CACdC,GAAId,EAAAe,QAAQC,GACZC,EAAGjB,EAAAe,QAAQG,EACXrC,EAAGmB,EAAAe,QAAQI,EACXC,IAAKpB,EAAAe,QAAQM,SACbC,SAAUtB,EAAAe,QAAQM,SAClBE,QAASvB,EAAAe,QAAQS,QACjBC,IAAKzB,EAAAe,QAAQW,KAMXC,EAA0D,CAC5DC,MAAA,WAAU,OAAOnB,EAAKmB,MAAM3D,OAC5B4D,GAAI7B,EAAAe,QAAQe,UAAUC,KAMpBC,EAA4C,CAC9CC,IAAYjC,EAAAe,QAAQe,UAAUG,IAC9BC,UAAA,WAAc,OAAOjE,MACrBkE,SAAYnC,EAAAe,QAAQe,UAAUM,IAC9BC,WAAYrC,EAAAe,QAAQe,UAAUQ,IAC9BC,SAAYvC,EAAAe,QAAQe,UAAUU,IAC9BC,OAAYzC,EAAAe,QAAQe,UAAUY,IAC9BC,IAAY3C,EAAAe,QAAQe,UAAUa,IAC9BC,UAAA,WAAc,OAAOnC,EAAKmB,MAAW3D,KAAKgE,IAAI,MAqElD,SAASY,EAAOC,GACZ,IAAIC,EAAWD,EAATC,KAGN,GAAa,OADbA,EAAOA,EAAKC,eACM,MAAO,CAAEC,KAAM,KAEjC,GAAIzC,EAAc0C,SAASH,GAAO,MAAO,CAAEE,KAAM,SAAUE,EAAG3C,EAAc4C,IAAIL,IAChF,GAAIA,KAAQlC,EAAW,MAAO,CAC1BoC,KAAM,WACNxF,MAAOoD,EAAUkC,IAErB,GAAIA,KAAQpB,EAAW,MAAO,CAC1BsB,KAAM,SACNE,EAAGxB,EAAUoB,IAGjB,MAAM,IAAI9D,MAAM,wBAA6BoE,OAALN,EAAK,MASjD,SAASO,EAAOC,EAAiBC,GAC7B,GAAiB,aAAbD,EAAIN,KAAqB,OAAOM,EAAI9F,MACxC,GAAiB,aAAb8F,EAAIN,KAAqB,OAAOM,EAAIJ,EAAEK,GAC1C,GAAiB,MAAbD,EAAIN,KAAc,OAAOO,EAG7B,MAAM,IAAIvE,MAAM,4BAA8CoE,OAAlBE,EAAaN,OAG7D,SAASQ,EACLN,EACAjF,GAEA,IAAIwF,EAAQxF,EAAKyF,KAAI,SAAAC,G,OAAQC,EAAKD,MAGlC,GAAIF,EAAMI,OAAM,SAACC,G,MAAwC,aAAXA,EAAEd,QAAsB,CAClE,IAAwBe,EAAuB9D,EAAvBwD,EAAMC,KAAI,SAAAM,G,OAAKA,EAAExG,UAAlCO,EAAiBgG,EAAuB,GAAlCE,EAAWF,EAAuBG,MAAlC,GAEPC,GAAQ,EAAApE,EAAAe,SAAQ/C,GACtB,MAAO,CAAEiF,KAAM,WAAYxF,MAAO0F,EAAE/E,MAAMgG,EAAOF,IAGrD,IAAwBG,EAAKnE,EAALwD,GAAjBY,EAAiBD,EAAK,GAAhBE,EAAWF,EAAKF,MAAhB,GAEb,MAAO,CACHlB,KAAM,WACNE,EAAG,SAAAK,GACC,IAAIO,GAAI,EAAA/D,EAAAe,SAAQuC,EAAOgB,EAAMd,IACzBgB,EAAID,EAAKZ,KAAI,SAAApG,G,OAAO+F,EAAO/F,EAAKiG,MAEpC,OAAOL,EAAE/E,MAAM2F,EAAGS,KAU9B,SAASX,EAAKf,GACV,OAAQA,EAAEG,MACN,IAAK,eACD,MAAO,CAAEA,KAAM,WAAYxF,MAAOqF,EAAErF,OACxC,IAAK,eACD,IAAMgH,EAAK5B,EAAOC,EAAE/E,IAEpB,GAAgB,WAAZ0G,EAAGxB,KACH,OAAOQ,EAAegB,EAAGtB,EAAGL,EAAE5E,MAC3B,GAAgB,aAAZuG,EAAGxB,KACV,MAAM,IAAIhE,MAAM,oCAAmDoE,OAAfP,EAAE/E,GAAGgF,KAAK,OAAcM,OAAToB,EAAGhH,MAAM,MACzE,GAAgB,MAAZgH,EAAGxB,KACV,MAAM,IAAIhE,MAAO,8BAIrB,MAAM,IAAIA,MAAM,2BAA4CoE,OAAjBoB,EAAYxB,KAAK,MAEhE,IAAK,eACD,IAAMyB,EA9FlB,SAAoBC,EAAMC,GACtB,GAAIA,KAAKD,EAAG,OAAOA,EAAWC,GA6FXC,CAAQ7C,EAAWc,EAAE/E,IAC1BoF,EAAIuB,EAAKjB,EAAeiB,EAAI5B,EAAE5E,WAAQI,EAE5C,QAAiB,IAAN6E,EAAmB,MAAM,IAAIlE,MAAM,wBAA6BoE,OAALP,EAAE4B,GAAG,MAC3E,OAAOvB,EAEX,IAAK,kBACD,OAAOU,EAAKf,EAAEgC,SAClB,IAAK,aACD,IAAMC,EAAKlC,EAAOC,GAGlB,GAAgB,WAAZiC,EAAG9B,KACH,MAAM,IAAIhE,MAAM,wBAA+BoE,OAAPP,EAAEC,KAAK,MAGnD,OAAOgC,EAEX,QACI,MAAM,IAAI9F,MAAM,iBAAwBoE,OAAPP,EAAEG,KAAK,6BAS7C,SAAS+B,EAAQC,GACpB,IAAMC,EAAKrB,EAAKpD,EAAKV,MAAMkF,IAE3B,OAAQC,EAAGjC,MACP,IAAK,WACD,MAAO,CACHA,KAAM,WACNE,EAAG+B,EAAGzH,OAEd,IAAK,WACD,OAAOyH,EACX,IAAK,IACD,MAAO,CACHjC,KAAM,WACNE,EAAG,SAAAK,G,OAAKA,IAEhB,QAEI,MAAM,IAAIvE,MAAM,4BAA6CoE,OAAjB6B,EAAYjC,S,EA7K1DzC,MAAa,KAMH0C,SAAT,SAAkB0B,GACrB,OAAOA,KAAK5E,EAAAe,QAAQe,W,EAQRsB,IAAT,SAAawB,GAChB,IAAMO,EAAInF,EAAAe,QAAQe,UAAU8C,GAE5B,OAAIO,aAAaC,SAAiBD,EAC3B,WAAa,OAAOlH,KAAK2G,K,EAGpBS,KAAT,SAAclC,GACjB,OAAO,WAAa,OAAOA,EAAElF,QCtFrC,IAAMqH,GAAO,EAAA5E,EAAAC,QAAOD,EAAAE,KAEd2E,EAAiBC,SAASC,cAA8B,eACxDC,EAAiBF,SAASC,cAA8B,gBACxDE,EAAiBH,SAASC,cAAgC,oBAC1DG,EAAiBJ,SAASC,cAAiC,iBAC3DI,EAAiBL,SAASC,cAA8B,oBACxDK,EAAiBN,SAASO,iBAA8B,sBACxDC,EAAiBR,SAASO,iBAAoC,eAC9DE,EAAiBT,SAASC,cAAgC,oBAC1DS,EAAiBV,SAASO,iBAAmC,sBAC7DI,EAAiBX,SAASC,cAAiC,0BAC3DW,EAAiBZ,SAASC,cAAiC,sBAC3DY,EAAiBb,SAASO,iBAA8B,WAExDO,EAASd,SAASe,cAAc,UAChCC,EAAMF,EAAOG,WAAW,KAAM,CAACC,OAAO,I,SAI7BC,I,OAAAC,EAAgBxI,MAAAH,KAAAE,W,SAAhByI,I,OAAAA,EAAf9I,EAAA+I,EAAAC,GAAAC,MAAA,SAAAC,I,IAE8BhD,EAAlBiD,EAAOC,E,kFADTC,K,OACoBnD,EAAAsC,EAAOc,wBAAzBH,EAAkBjD,EAAlBiD,MAAOC,EAAWlD,EAAXkD,OACfG,GAAYf,EAAQ,QAAUgB,KAAKC,MAAMN,IACzCI,GAAYf,EAAQ,SAAUgB,KAAKC,MAAML,IACzCV,EAAIgB,yBAA2B,OAE/BC,K,4CAP2BrJ,MAAAH,KAAAE,WAF/BoH,EAAQmC,YAAYpB,GAWpBK,IAEA,IAGUgB,E,EAUUC,EAgBAC,EAuBAC,EAhDVC,EAJJC,EAAYxC,SAASe,cAAc,UACnC0B,GAAOD,EAAUvB,WAAW,KAAM,CAACC,OAAO,I,EAEtCiB,MAAM,IAUIC,EAAT,WACEG,EAASG,OACVF,EAAUf,MAAQX,EAAOW,MACzBe,EAAUd,OAASZ,EAAOY,OAC1Be,GAAKT,yBAA2B,OAChCS,GAAKE,uBAAwB,EAC7BF,GAAKG,UAAU9B,EAAQ,EAAG,GAE1ByB,EAASM,IAAM/C,EAAKgD,SAAS,IAEjCP,EAASG,QAMGL,EAAT,WACHE,EAASG,KAAOZ,KAAKiB,IAAIR,EAASG,KAAO,EAAG,IAsBhCJ,EAAT,WACH,GAAIC,EAASG,KAAM,CACf,IAAMG,EAAUN,EAARM,IAilBhBG,KACAA,IAAW,EA/kBHhC,EAAIiC,aACAJ,EAAIjF,IAAI,CAAC,EAAG,IACZiF,EAAIjF,IAAI,CAAC,EAAG,IACZiF,EAAIjF,IAAI,CAAC,EAAG,IACZiF,EAAIjF,IAAI,CAAC,EAAG,IACZiF,EAAIjF,IAAI,CAAC,EAAG,IACZiF,EAAIjF,IAAI,CAAC,EAAG,KAEhBoD,EAAI4B,UAAUJ,EAAW,EAAG,GAC5BxB,EAAIkC,mBA9DNX,EAAW,CACbG,KAAM,EACNG,IAAK/C,EAAKgD,SAAS,I,EAOPV,U,EAgBAC,U,EAWAc,OAAT,SAAgBxF,G,IAA4ByF,IAAAzK,UAAAW,OAAA,YAAAX,UAAA,KAA2BA,UAAA,GACpE0K,EAA0B,IAAlBd,EAASG,KAEvBN,IACAzE,EAAE0F,GACED,GAAeC,GAAOf,IAC1BD,K,EAMYC,O,EAuBAgB,UAAT,SAAmBC,EAAYC,GAClCjB,EAASM,IAAM/C,EAAK/C,SAChB+C,EAAK2D,OAAO,CACR,CAAC,EAAG,EAAGF,GACP,CAAC,EAAG,EAAGC,GACP,CAAC,EAAG,EAAI,KAEZjB,EAASM,M,EASDa,YAAT,SAAqBC,EAAeC,GACvC,IAAiBpF,GAA2D,EAAAqF,EAAAjJ,SAA3DgJ,UAAU,EAAE9C,EAAOW,MAAQ,GAAK,GAAIX,EAAOY,OAAS,GAAK,GAAE,GAArE6B,EAAU/E,EAA2D,GAAjEgF,EAAMhF,EAA2D,GAE5E+D,EAASM,IAAM/C,EAAKgE,MAChBhE,EAAK2D,OAAO,CACR,CAAC,EAAG,EAAGF,GACP,CAAC,EAAG,EAAGC,GACP,CAAC,EAAG,EAAI,MAEdzG,SACE+C,EAAK2D,OAAO,CACR,CAAC,EAAIE,EAAe,EAAG,GACvB,CAAS,EAAG,EAAIA,EAAO,GACvB,CAAS,EAAW,EAAG,MAE7B5G,SACE+C,EAAK2D,OAAO,CACR,CAAC,EAAG,GAAIF,GACR,CAAC,EAAG,GAAIC,GACR,CAAC,EAAG,EAAK,MAEfzG,SACEwF,EAASM,KACX1K,QAIV,IAAI4L,GAASvJ,EAAAe,QAAQyI,KAErB,SAASC,GAAUxF,EAAYyF,G,IACvB1F,GAAyB,QAAzBA,EAAA0F,aAAA,EAAAA,EAAaC,oBAAY,IAAzB3F,OAAmC2D,EAAOgB,QAAO,W,IAMjDiB,EAFMC,EAAKN,GAAOnH,IAAI6B,GAChB6F,EAAWC,GAAQC,iBAAiBH,IAC1CD,EAAAjC,GAAOmB,UAAP1K,MAAAwL,GAAiB,EAAAK,EAAA7J,SAAG0J,OAExBP,GAAStF,EAETiC,EAAa,GAAGzI,MAAQ,GAAQ4F,OAALY,EAAEiG,IAC7BhE,EAAa,GAAGzI,MAAQ,GAAQ4F,OAALY,EAAEkG,IAC7BC,GAAejE,EAAgBlC,EAAEoG,OAAO,EAAG,IAC3CD,GAAehE,EAAYnC,EAAEoG,OAAO,EAAG,IAAgB,IAAVC,IAE7C7C,KAIAjC,SAASO,iBAAkC,yBAAyBwE,SAAQ,SAAApH,GACxEA,EAAEqH,iBAAiB,UAAU,SAAAvJ,GACzB,IAAMiJ,GAAMhE,EAAa,GAAGzI,MACtB0M,GAAMjE,EAAa,GAAGzI,MAG5BgM,IAFU,EAAAzJ,EAAAe,SAAQmJ,EAAIC,UAK9BhE,EAAeqE,iBAAiB,SAAS,SAAAvJ,GACrCwI,GAAUzJ,EAAAe,QAAQyI,SAQ1B,IAAIhB,GAAU,EAMV8B,GAAQ,EAEZ,SAASG,GAAS3H,EAAW4G,G,IAGrB1F,EAFJlB,EAAIwE,KAAKiB,IAAIzF,EAAG4H,OAAOlJ,SACvBmJ,QAAQ5I,IAAIe,IACiB,QAAzBkB,EAAA0F,aAAA,EAAAA,EAAaC,oBAAY,IAAzB3F,OAAmC2D,EAAOgB,QAAO,WACjD,IAAMiC,EAAa9H,EAAIwH,GACvB3C,EAAOuB,YAAY0B,MAEvBN,GAAQxH,EAERmD,EAAUxI,MAAQ,GAAa4F,OAAV,EAAIiH,IACzBrE,EAAU4E,MAAM5D,MAAQ,GAA0B5D,OAAvB4C,EAAUxI,MAAMqB,OAAO,MAElDkH,EAAY,GAAG8E,SAAqB,IAAVR,GAE1BF,GAAehE,EAAYmD,GAAOc,OAAO,EAAG,IAAgB,IAAVC,IAClD7C,KAGJ,SAASsD,GAAQC,EAAgBC,EAAgBC,GAI7C,IAAMC,EAAS7D,KAAA3E,IAAA,EAAe,KAATuI,GAEfE,EAAWrB,GAAQsB,UAAUL,EAAQC,GAIrCK,EAAOF,EAAShJ,IAAImH,IAE1B5B,EAAOgB,QAAO,WACVc,GAAU2B,EAAShJ,IAAIkJ,EAAK9I,IAAI2I,KAChCV,GAASH,GAAQa,MAMrB,IAAqCI,IAAW,EAAAlC,EAAAjJ,SAAX4F,EAAW,GAAzCwF,GAA8BD,GAAW,GAAjCE,GAAsBF,GAAW,GAAtBG,GAAWH,GAAW,GAcpD,SAASI,KACL,MAAO,CACHrB,GAAQhE,EAAOW,MAAQX,EAAOY,OAC9BoD,IAGR,SAAS7C,KACL,IAAMmE,KAAiBC,iBAAiBrG,SAASsG,iBAC5CC,iBAAiB,kBAEG/H,GAAS,EAAAqF,EAAAjJ,SAATuL,KAAS,GAA3BK,EAAkBhI,EAAS,GAAnBiI,EAAUjI,EAAS,GAE5BkI,GAAQ,EAAAlM,EAAAe,SAAQiL,EAAQC,GAExBE,EAAM5C,GAAOnH,IAAI8J,GACjBE,EAAM7C,GAAOtH,IAAIiK,GAEvB,GAAKN,EAGE,CACH,IAAMS,EAAqBF,EAArBjC,GAASoC,EAAYH,EAAZhC,GACToC,EAAqBH,EAArBlC,GAASsC,EAAYJ,EAAZjC,GAETsC,GAA2B,IAAnBnF,KAAKoF,KAAKJ,GAAc,IAAM,IACtCK,GAA2B,IAAnBrF,KAAKoF,KAAKJ,GAAc,IAAM,IAEtCM,EAASC,GAAaR,GACtBS,EAASD,GAAaN,GACtBQ,EAASF,GAAavF,KAAK0F,IAAIV,IAC/BW,EAASJ,GAAavF,KAAK0F,IAAIR,IAErCnG,EAAO,GAAG6G,YAAc,GAAa7J,OAAVuJ,EAAO,KAAYvJ,OAAToJ,EAAM,KAAUpJ,OAAP0J,EAAO,KACrD1G,EAAO,GAAG6G,YAAc,GAAa7J,OAAVyJ,EAAO,KAAYzJ,OAATsJ,EAAM,KAAUtJ,OAAP4J,EAAO,UAfrD5G,EAAO,GAAG6G,YAAc,GAAO7J,OAAJ8I,GAC3B9F,EAAO,GAAG6G,YAAc,GAAO7J,OAAJ+I,GAkBnC,SAASS,GAAa/J,GAClB,IAAMqK,EAAKrK,EAAEsK,cACPC,EAAKvK,EAAEsK,YAAY,GAEzB,OAAID,EAAGrO,QAAUuO,EAAGvO,OAAeqO,EAC5BE,EAtDP7B,GAAOhB,iBAAiB,SAAY,W,OAAMC,GAASH,GAAQ,MAC3DmB,GAAUjB,iBAAiB,SAAS,W,OAAMC,GAAS,MACnDiB,GAAQlB,iBAAiB,SAAW,W,OAAMC,GAAiB,EAARH,OACtDlE,EAEUoE,iBAAiB,SAAS,WACjC7C,EAAOgB,QAAO,WACVc,GAAUzJ,EAAAe,QAAQyI,MAClBiB,GAAS,SAuDjB,IAEI6C,GACAC,G,MAHAC,GAAkC,SAAAhK,G,OAAKA,GC7S3CiK,GAAiB,SAAUC,EAAWC,EAAQC,GAC5C,GAAID,IAAW3P,KAAK6P,SAASF,OAG3B,OAAOD,EAGP,IAAII,EAASF,EAAQ,UAAY9N,KAAKiO,UAAUL,GAAa,IAAM,iBAAmB5N,KAAKiO,UAAUL,GAAa,KAClH,OAAOM,IAAIC,gBAAgB,IAAIC,KAAK,CAACJ,GAAS,CAC5C7K,KAAM,6B,ICTRkL,I,eAAMC,aAAuB,SAAWxO,EAAA,SAAA1C,QAA6C,SAASmR,GAAiBZ,GAAUU,GAAKG,GAAAC,UAAoBJ,KAAM,GFsT5J,IAAIK,GAAa,IAAIC,OAAMJ,IAC3BG,GAAWE,iBAAYpQ,G,OGvTnBqQ,I,eAAMP,aAAuB,SAAWxO,EAAA,SAAA1C,QAA6C,SAAS0R,GAAiBnB,GAAUkB,GAAKL,GAAAC,UAAoBI,KAAM,G,aCAxJE,I,eAAMT,aAAuB,SAAWxO,EAAA,SAAA1C,QAA6C,SJ2VzF,SAAS4R,GAAkBC,G,IAACC,EAADD,EAACC,MAAOC,EAARF,EAAQE,MACzBC,EAAIF,EAAQ1I,EAAO6I,WACnBC,EAAIH,EAAQ3I,EAAO+I,UAECrL,EAAAsC,EAAOc,wBAAzBH,EAAkBjD,EAAlBiD,MAAOC,EAAWlD,EAAXkD,OACf,KAAKgI,EAAI,GAAKA,GAAKjI,GACdmI,EAAI,GAAKA,GAAKlI,GAEnB,OAAO6C,GAAQsB,UAAU6D,EAAGE,GInWkEE,GAAiB7B,GAAUoB,GAAKP,GAAAC,UAAoBM,KAAM,GJwT5JL,GAAWe,W,GAAYzR,EAAA+I,EAAAC,GAAAC,MAAA,SAAAC,EAAgBwI,G,yEACnC3J,EAAYqH,YAAc,0B,SACpB/F,K,cACNoG,GAAUiC,EAAEC,KAEZnC,GAASC,GACH,IAAIkB,OAAMG,IACV,IAAIH,OAAMa,I,SAEVI,GAAWpC,I,OAEjBA,GAAOiC,UAAY,SAAUtO,GACzB,IA2WewO,EACdE,EAAOC,EAERC,EA9WIC,EAAe7O,EAAEwO,KACjBK,EAAIC,UAAYvH,KAED,cAAfsH,EAAIE,QAyWPL,GADcF,EAvWEK,GAwWhBH,MAAOC,EAAOH,EAAPG,IAERC,EAAM,IAAII,UAAU,IAAIC,kBAAkBN,GAAMD,EAAM1I,MAAO0I,EAAMzI,QACvEV,EAAI2J,aAAaN,EAAKF,EAAMS,KAAMT,EAAMU,OA1WV,SAAfP,EAAIE,QACXM,GAASR,EAAIS,QAMrBjD,GAAOkD,QAAUC,GACjB7K,EAAYkF,UAAW,EACvB0D,GAAWkC,YAEXlL,SAASO,iBAAiB,iBAAiBwE,SAAQ,SAAAtJ,G,OAAKA,EAAE0P,UAAUC,OAAO,mBAC3EC,K,qDA7BmCrB,G,sCAiE1BsB,GAAT,SAAmB7P,GACf,IAAM8P,EAAMC,GAAM5N,IAAInC,EAAEgQ,WAMxB,GAJID,GAAME,OAAOjQ,EAAEgQ,YACftJ,EAAOE,UAGQ,IAAfmJ,GAAMG,MAAcJ,EAAK,CAEzB,IAAiB/M,EAAA,CACb/C,EAAEmQ,QAAUL,EAAIM,MAChBpQ,EAAEqQ,QAAUP,EAAIQ,OAGT,IALMvN,EAGhB,IAEsB,IALNA,EAGhB,IAEyB6M,OAOzBW,GAAT,SAAkBC,GACd,IAAM3S,EAAS2S,EAAI3S,OACAkF,GAA+D,EAAAqF,EAAAjJ,SAA/DqR,EAAIC,QAAO,SAAA3C,EAAA4C,G,yBAAEC,EAAEC,EAAA,GAAEC,EAAED,EAAA,GAAAE,GAAA,EAAA1I,EAAAjJ,SAAAuR,EAAA,G,MAAgB,CAACC,EAAXG,EAAA,GAAoBD,EAAhBC,EAAA,OAAkC,GAE5EC,EAAS,CAFIhO,EAA+D,GAE5DlF,EAFHkF,EAA+D,GAE9ClF,GACnBmT,GAAM,EAAA5I,EAAAjJ,SAAN4R,EAAM,GAAhBE,EAAUD,EAAM,GAAZE,EAAMF,EAAM,GAKvB,MAAO,CAACD,EAHUP,EAAI9N,KAAI,SAAAoL,G,yBAAEG,EAAC2C,EAAA,GAAEzC,EAACyC,EAAA,G,OAAMvK,KAAK8K,MAAMlD,EAAIgD,EAAI9C,EAAI+C,MAC7BT,QAAO,SAACW,EAAKC,G,OAAOD,EAAMC,OA/C1DtB,GAAQ,IAAIuB,IAOhBjM,EAAOkE,iBAAiB,eAAe,SAAAvJ,GAGnC,IAAIoQ,EAAOE,EAAOiB,EAAOC,EAFzB9H,QAAQ5I,IAAI,cAAed,EAAEgQ,WAG7BuB,EAAQnB,EAAQpQ,EAAEmQ,QAClBqB,EAAQlB,EAAQtQ,EAAEqQ,QAClBN,GAAM0B,IAAIzR,EAAEgQ,UAAW,CAACI,QAAOE,QAAOiB,QAAOC,UAE7C9K,EAAOC,aAqBXpC,SAASgF,iBAAiB,YAAasG,IACvCtL,SAASgF,iBAAiB,gBAAiBsG,IAe3CtL,SAASgF,iBAAiB,eAAe,SAAAvJ,GACrC0J,QAAQ5I,IAAI,cAAed,EAAEgQ,WAE7B,IAAMF,EAAMC,GAAM5N,IAAInC,EAAEgQ,WACxB,GAAIF,EACA,GAAmB,IAAfC,GAAMG,KAAY,CAClB,IAAiBnN,EAAA,CACb/C,EAAEmQ,QAAUL,EAAIyB,MAChBvR,EAAEqQ,QAAUP,EAAI0B,OAFb1J,EAAU/E,EAGhB,GAHUgF,EAAMhF,EAGhB,GAEK6F,EAAKE,GAAQ4I,kBAAkB5J,EAAIC,GACzCS,GAAUF,GAAOnH,IAAIyH,IACrBlC,EAAOG,OAEPiJ,EAAIyB,MAAQvR,EAAEmQ,QACdL,EAAI0B,MAAQxR,EAAEqQ,YACX,CACH,IAAIsB,EAAYC,MAAMC,KAAK9B,GAAM+B,UAAU,SAAAhE,G,MAAoB,CAAbA,EAALyD,MAAYzD,EAAL0D,UACpCO,GAAmB,EAAA3J,EAAAjJ,SAAnBoR,GAASoB,GAAU,GAAzBK,GAAMD,EAAmB,GAAnBA,EAAmB,IAEnCjC,EAAIyB,MAAQvR,EAAEmQ,QACdL,EAAI0B,MAAQxR,EAAEqQ,QAEdsB,EAAYC,MAAMC,KAAK9B,GAAM+B,UAAU,SAAAhE,G,MAAoB,CAAbA,EAALyD,MAAYzD,EAAL0D,UAChD,IAAgBS,GAAmB,EAAA7J,EAAAjJ,SAAnBoR,GAASoB,GAAU,GAA5B3O,EAASiP,EAAmB,GAAzBC,EAAMD,EAAmB,GAEnCnI,GAAA3M,WAAA,KAAQ6L,EAAA7J,SAAG6D,GAAAZ,OAAX,CAAc4P,EAAKE,KACnBxL,EAAOG,WAOnB,IAAIsL,GA6DJC,GAyDMtJ,G,GA0BU4I,GAmCA3I,GAlLZsJ,IAAU,EAoCjB,SAKcC,K,OAAAC,GAAiBpV,MAAAH,KAAAE,W,SAAjBqV,K,OAAAA,GAAf1V,EAAA+I,EAAAC,GAAAC,MAAA,SAAAC,I,IAAiCyM,EAAGvV,EAAHwV,EACvB3C,EAGsB4C,EAAjBC,EAAOC,EAGU7P,EAAQ8P,EAAA3V,U,kEAPP,IAAAsV,EAA6CK,EAA7ChV,OAAAZ,EAAA,IAAA2U,MAAAY,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAAxV,EAAAwV,GAA6CI,EAA7CJ,QAGV,KAFb3C,EAAMjC,GAAA1Q,WAAA,GAAkB,EAAA6L,EAAA7J,SAAGlC,OAGLyV,GAAa,EAAAtK,EAAAjJ,SAAb0F,EAAa,GAA9B8N,EAAiBD,EAAa,GAAvBE,EAAUF,EAAa,GAErCC,EAAM1G,YAAe,GAAO7J,OAAJ0N,GACxB8C,EAAO3G,YAAc,GAAmB7J,OAAR,QAARW,EAAAwJ,cAAA,EAAAA,GAAIuD,UAAI,IAAR/M,IAAY,M,2CAP7BwP,GAAiBpV,MAAAH,KAAAE,W,SA2CjB0S,K,OAAAkD,GAAK3V,MAAAH,KAAAE,W,SAAL4V,K,OAAAA,GAAfjW,EAAA+I,EAAAC,GAAAC,MAAA,SAAAC,I,IASQ/B,EAEM+O,E,sEAVNpO,EAAYkF,SAAQ,C,uDAExBjF,EAAY8K,UAAUC,OAAO,SAAU,QAAS,QAChD/K,EAAYqH,YAAc,c,SAEpBvG,I,uBACAQ,K,OAEFlC,EAAOU,EAAUlI,M,SAEXuW,EAAMhP,EAAkBC,GACDuI,GAAZ,aAAbwG,EAAI/Q,KAAyB+Q,EAAI7Q,EAC5B,W,OAAM6Q,EAAI7Q,GAEnB8Q,GAAY3G,GAAQrI,G,wBAGpB,M,0BADAwL,GAAcyD,EAAAC,IACdD,EAAAC,G,2DAlBY/V,MAAAH,KAAAE,W,SAyBLgJ,K,OAAAiN,GAAchW,MAAAH,KAAAE,W,SAAdiW,K,OAAAA,GAAftW,EAAA+I,EAAAC,GAAAC,MAAA,SAAAC,I,2FACW,IAAIpJ,SAAc,SAAAV,GACrBmX,uBAAsB,WAClBA,uBAAsB,W,OAAMnX,c,4CAHXkB,MAAAH,KAAAE,W,SAwFduR,GAAW4E,G,OAAXC,GAAUnW,MAAAH,KAAAE,W,SAAVoW,K,OAAAA,GAAfzW,EAAA+I,EAAAC,GAAAC,MAAA,SAAAC,EAA0BsN,G,IAClBE,E,yEAAAA,EAAe,CAAExE,OAAQ,QAC7BsE,EAAE5F,YAAY8F,G,kBAEP,IAAI5W,SAAc,SAAAV,GACrBoX,EAAE/E,UAAY,SAAStO,GACnB/D,S,4CANakB,MAAAH,KAAAE,WAgBzB,SAAS8V,GAAYK,EAAWrP,GAC5BuD,KACAA,IAAW,EAEX,IAAIsH,EAAc,CACdE,OAAQ,cACRyE,IAAKC,GAAgBzP,GACrB0P,GAAI,CACA1N,MAAOX,EAAOW,MACdC,OAAQZ,EAAOY,OACf0N,OAAQ,CAACrL,GAAOW,GAAIX,GAAOY,IAC3B0K,MAAAvK,IAEJyF,QAAAvH,IAEJ8L,EAAE5F,YAAYoB,GAyBlB,SAAS4E,GAAgBzP,GACrB,IAAIrB,EAAO0B,EAAKwP,SAAS7P,GAErB8P,GAAU,EAOd,MANiB,gBAAbnR,EAAKX,MAAqC,UAAXW,EAAK7F,IAAmBiX,OAAOpR,EAAK1F,KAAK,MACxE0F,EAAK1F,KAAK+W,UACVrR,EAAO0B,EAAKwP,SAASlR,GACrBmR,GAAU,GAGP,CAAE9P,KAAMrB,EAAKsR,WAAYH,W,SAOrBzE,GAAS6E,G,OAATC,GAAQhX,MAAAH,KAAAE,W,SAARiX,K,OAAAA,GAAftX,EAAA+I,EAAAC,GAAAC,MAAA,SAAAC,EAAwBmO,G,yEACpBtP,EAAYqH,YAAc,WAAa7J,OAAF8R,EAAE,OACvCtP,EAAY8K,UAAU1O,IAAI,Q,SAEpBkF,K,OACNkO,K,4CALmBjX,MAAAH,KAAAE,WAYvB,SAASsS,GAAexP,GACpB,IAAI5C,EAAM4C,aAAaqU,WAAarU,EAAEsU,QAAUtU,EAEhD4E,EAAY8K,UAAU1O,IAAI,SAC1B4D,EAAYqH,YAAcsI,OAAOnX,GAOrC,SAASgX,K,IAAiBI,EAAAtX,UAAAW,OAAA,YAAAX,UAAA,GAAYA,UAAA,GAAJ,IAC9BuX,YAAW,WACH7P,EAAY8K,UAAUgF,SAAS,UAC/B9P,EAAY8K,UAAUC,OAAO,QAC7B/K,EAAY8K,UAAU1O,IAAI,aAE/BwT,GAGP,SAASpO,GAAmD1C,EAAkBiR,EAAMC,GAC5ElR,EAAEiR,KAAOC,IAAGlR,EAAEiR,GAAKC,GAG3B,SAASzL,GAAe5F,EAAgBsR,GACpCtR,EAAEmM,UAAUoF,OAAO,SAAUD,GACzBtR,aAAawR,oBAAmBxR,EAAEsG,SAAWgL,GAlTjDxP,EAAOkE,iBAAiB,SAAS,SAAAvJ,GAa7B,GAZAA,EAAEgV,iBACFC,aAAa9C,IAERE,KACDA,IAAU,EAGV3L,EAAOC,WAKP3G,EAAEkV,QACFpL,GAAQ9J,EAAEmQ,QAASnQ,EAAEqQ,QAASrQ,EAAEiK,QAChCvD,EAAOG,WACJ,CACH,IAAMiB,EAAgB,GAAX9H,EAAEmV,OACPpN,EAAgB,GAAX/H,EAAEiK,OAEPrB,EAAKE,GAAQ4I,kBAAkB5J,EAAIC,GACzCS,GAAUF,GAAOnH,IAAIyH,IACrBlC,EAAOG,OAGXyL,GAAkBtS,GAElBmS,GAAUsC,YAAW,WAEjB7E,KACAlJ,EAAOE,UACPyL,IAAU,IACX,QACJ,GAgBPhN,EAAOkE,iBAAiB,YAAa+I,IACrC7N,EAAS8E,iBAAiB,YAAa+I,IACvC/N,SAASgF,iBAAiB,QAAS+I,IAQnC8C,OAAO7L,iBAAiB,UAAU,SAAAvJ,QACH,IAAhBoS,IAA6B6C,aAAa7C,IAErDA,GAAcqC,WAAW5X,EAAA+I,EAAAC,GAAAC,MAAA,SAAAC,I,kFAAkB6J,K,mFAAS,QAGxDrL,SAASC,cAA+B,kBAAmB+E,iBAAiB,UAAU,WAC9EvE,EAAUqQ,iBAAiB7L,GAAS,GAAKxE,EAAUxI,UAI3D+H,SAASO,iBAAkC,qBAAqBwE,SAAQ,SAAApH,GACpEA,EAAEqH,iBAAiB,UAAU,SAAAvJ,GACzBA,EAAEgV,iBACFpF,WAGRrL,SAASO,iBAAoC,uBAAuBwE,SAAQ,SAAA/F,GACxEA,EAAEgG,iBAAiB,SAAS,WACxBqG,W,GAqCE9G,QAAO,IA0BG4I,GAAT,SAA2B5J,EAAYC,GAC1C,IAAQ/B,EAAkBX,EAAlBW,MAAOC,EAAWZ,EAAXY,OACUlD,GAAS,EAAAqF,EAAAjJ,SAATuL,KAAS,GAA3BK,EAAkBhI,EAAS,GAAnBiI,EAAUjI,EAAS,GAGXuS,EAAA,EACjBtP,EAAS,GAAK,IACdC,EAAS,GAAK,GAFbsP,EAAgBD,EAGtB,GAHaE,EAASF,EAGtB,GAED,OAAO,EAAAvW,EAAAe,SAAQgI,EAAKiD,EAASwK,EAAOxN,EAAKiD,EAASwK,IAyBtCzM,GAAT,SAA0BH,GAC7B,IAAQ5C,EAAkBX,EAAlBW,MAAOC,EAAWZ,EAAXY,OACUlD,GAAS,EAAAqF,EAAAjJ,SAATuL,KAAS,GAA3BK,EAAkBhI,EAAS,GAAnBiI,EAAUjI,EAAS,GAGX0S,EAAA,EACjBzP,EAAS,GAAK,IACdC,EAAS,GAAK,GAFbsP,EAAgBE,EAGtB,GAHaD,EAASC,EAGtB,GAED,MAAO,CAAC7M,EAAGK,GAAKsM,EAAQxK,EAAQnC,EAAGM,GAAKsM,EAAQxK,I,GAhEpCZ,UAAT,SAAmB6D,EAAWE,GACjC,IAAuCpL,EAAA,EAClCsC,EAAOW,MAAS,GAAK,GACrBX,EAAOY,OAAS,GAAK,GAGpB2C,EAAK8I,GACPzD,EANmClL,EAGtC,GAIGoL,EAPmCpL,EAGtC,IAMD,OAAOuF,GAAOtH,IAAI4H,I,GASN8I,qB,GAkBAgE,SAAT,SAAkBnT,GACrB,IAAuCQ,EAAA,EAClCsC,EAAOW,MAAS,GAAK,GACrBX,EAAOY,OAAS,GAAK,GAFnB0P,EAAgC5S,EAGtC,GAHqB6S,EAAiB7S,EAGtC,GAEK6F,EAAKrG,EAAEpB,IAAImH,IACAuN,GAAoB,EAAAzN,EAAAjJ,SAApB4J,GAAiBH,GAAG,GAErC,MAAO,CAAC+M,EAFSE,EAAoB,GAETD,EAFXC,EAAoB,K,GAUzB9M,oB","sources":["node_modules/.pnpm/@swc+helpers@0.4.3/node_modules/@swc/helpers/src/_async_to_generator.mjs","node_modules/.pnpm/@parcel+runtime-js@2.6.2_@parcel+core@2.6.2/node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/.pnpm/@parcel+runtime-js@2.6.2_@parcel+core@2.6.2/node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","node_modules/.pnpm/@parcel+runtime-js@2.6.2_@parcel+core@2.6.2/node_modules/@parcel/runtime-js/lib/runtime-59ab9fe03a57eca0.js","src/complexgrapher/types.ts","node_modules/.pnpm/@swc+helpers@0.4.3/node_modules/@swc/helpers/src/_to_array.mjs","src/complexgrapher/evaluator.ts","src/complexgrapher/complexgrapher.ts","node_modules/.pnpm/@parcel+runtime-js@2.6.2_@parcel+core@2.6.2/node_modules/@parcel/runtime-js/lib/helpers/get-worker-url.js","node_modules/.pnpm/@parcel+runtime-js@2.6.2_@parcel+core@2.6.2/node_modules/@parcel/runtime-js/lib/runtime-270ff6b1dfc95150.js","node_modules/.pnpm/@parcel+runtime-js@2.6.2_@parcel+core@2.6.2/node_modules/@parcel/runtime-js/lib/runtime-c450be412dcf1087.js","node_modules/.pnpm/@parcel+runtime-js@2.6.2_@parcel+core@2.6.2/node_modules/@parcel/runtime-js/lib/runtime-6e4d5139d6322c82.js"],"sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n","\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","\"use strict\";\n\nvar bundleURL = {};\n\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n\n  return value;\n}\n\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^)\\n]+/g);\n\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n} // TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\n\n\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\\/\\/[^/]+/);\n\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n\n  return matches[0];\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"5Hjnn\\\":\\\"complexgrapher.2cd5a0d0.js\\\",\\\"dq1cl\\\":\\\"webkitTest.5c78f70c.js\\\",\\\"egthy\\\":\\\"main.edf03ce0.js\\\",\\\"1GZwD\\\":\\\"main.66bf90c5.js\\\",\\\"ainsM\\\":\\\"chunkloader.35421398.js\\\",\\\"bumwR\\\":\\\"chunkloader.6b4af37c.js\\\",\\\"aUCA8\\\":\\\"complexgrapher.76607184.js\\\",\\\"33yRb\\\":\\\"complexgrapher.803d8665.js\\\"}\"));","import { Complex } from \"complex.js\";\nexport { Complex };\n\n/**\n * Canvas dimension data (width and height), as well as the current zoom level\n */\nexport interface CanvasData {\n    width: number,\n    height: number,\n\n    center: [number, number],\n    scale: number,\n}\n\n/**\n * Chunk data designating the size of the chunk and its offset from (0, 0) in canvas\n */\nexport interface ChunkData {\n    width: number,\n    height: number,\n    offx: number,\n    offy: number\n}\n\n/**\n * A partially evaluated function string.\n * The string here is already simplified, and the reciprocal optimization has already been applied,\n * but the is not fully computed to allow it to be passed as a Worker message.\n */\nexport interface PartialEvaluator {\n    fstr: string,\n    inverse: boolean\n}\n\ntype Numeric = Complex | number;\n\ninterface FunctionEvaluator { \n    type: \"function\",\n    f: ComplexFunction\n}\ninterface ConstantEvaluator { \n    type: \"constant\",\n    f: Numeric\n}\n\n/**\n * A fully evaluated function.\n * This has the sufficient knowledge to compute an output color from an input complex number.\n */\nexport interface Evaluator {\n    evaluator: FunctionEvaluator | ConstantEvaluator,\n\n    /**\n     * Signifies whether to use the reciprocal optimization: bfunc(1 / fz) = 1 - bfunc(fz)\n     */\n    inverse: boolean\n}\n\n/**\n * A function that takes a complex number to another complex number\n */\nexport type ComplexFunction = (z: Complex) => Numeric;\n\nnamespace Messages {\n    /**\n     * A request to compute the function across an entire canvas\n     */\n    export interface MainRequest {\n        action: \"mainRequest\",\n        pev: PartialEvaluator,\n        cd: CanvasData,\n        graphID: number\n    };\n    \n    /**\n     * Designation that the canvas is fully computed\n     */\n    export interface GraphDone {\n        action: \"done\",\n        time: number,\n        graphID: number\n    };\n\n    /**\n     * A request to compute the function across a chunk\n     */\n    export interface ChunkRequest {\n        action: \"chunkRequest\",\n        pev: PartialEvaluator,\n        cd: CanvasData,\n        chunk: ChunkData,\n        graphID: number\n    };\n\n    /**\n     * Designation that the chunk is fully computed (with the computed data from the chunk)\n     */\n    export interface ChunkDone {\n        action: \"chunkDone\",\n        chunk: ChunkData,\n        buf: ArrayBuffer,\n        graphID: number\n    };\n\n    /**\n     * Call to initialize\n     */\n    export interface Init {\n        action: \"init\"\n    };\n\n    /**\n     * Return call to designate initialization completed\n     */\n    export interface Ready {\n        action: \"ready\"\n    }\n\n}\nexport type InitIn = Messages.Init;\nexport type InitOut = Messages.Ready;\n\nexport type MainIn = Messages.MainRequest;\nexport type MainOut = Messages.ChunkDone | Messages.GraphDone;\n\nexport type LoaderIn = Messages.ChunkRequest;\nexport type LoaderOut = Messages.ChunkDone;","import arrayWithHoles from './_array_with_holes.mjs';\nimport iterableToArray from './_iterable_to_array.mjs';\nimport nonIterableRest from './_non_iterable_rest.mjs';\nimport unsupportedIterableToArray from './_unsupported_iterable_to_array.mjs';\n\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n","import { all, create } from \"mathjs\";\nimport { Complex, ComplexFunction, Evaluator } from \"./types\";\nconst math = create(all);\n\ntype Numeric = Complex | number;\ntype ComplexMethod<R = Numeric> = (this: Complex, ...args: any[]) => R;\n\n/**\n * A mapping of names to constants which they represent:\n */\nconst constants = {\n    pi: Complex.PI,\n    e: Complex.E,\n    i: Complex.I,\n    inf: Complex.INFINITY,\n    infinity: Complex.INFINITY,\n    epsilon: Complex.EPSILON,\n    nan: Complex.NAN\n} as const;\n\n/**\n * A mapping of names to functions (C -> C) which they represent.\n */\nconst functions: { readonly [s: string]: ComplexMethod<any> } = {\n    gamma() { return math.gamma(this as any); }, // slower than pure Complex.js, but oh well\n    ln: Complex.prototype.log,\n} as const;\n\n/**\n * A mapping of operators to their respective functions.\n */\nconst operators: { [s: string]: ComplexMethod } = {\n    add:        Complex.prototype.add,\n    unaryPlus() { return this; },\n    subtract:   Complex.prototype.sub,\n    unaryMinus: Complex.prototype.neg,\n    multiply:   Complex.prototype.mul,\n    divide:     Complex.prototype.div,\n    pow:        Complex.prototype.pow,\n    factorial() { return math.gamma<any>(this.add(1)); },\n} as const;\n\nnamespace Results {\n    export interface Z {\n        type: \"z\"\n    }\n\n    export interface Constant {\n        type: \"constant\",\n        value: Numeric\n    }\n\n    export interface Method {\n        type: \"method\",\n        f: ComplexMethod<any>\n    }\n    \n    export interface Function {\n        type: \"function\",\n        f: ComplexFunction\n    }\n}\n\ntype LookupResult = Results.Z | Results.Method | Results.Constant;\ntype FoldResult   = Results.Z | Results.Function | Results.Constant;\n\nnamespace ComplexMethod {\n    /**\n     * Checks if this is a valid method on Complex\n     * @param k the method to check\n     * @returns if it is\n     */\n    export function isMethod(k: string): k is keyof Complex {\n        return k in Complex.prototype;\n    }\n\n    /**\n     * Gets a complex method from the given key.\n     * @param k key\n     * @returns a complex method (this will be the prototype method if already a method or a wrapper method if not)\n     */\n    export function get(k: keyof Complex): ComplexMethod<any> {\n        const m = Complex.prototype[k];\n    \n        if (m instanceof Function) return m;\n        return function() { return this[k]; }\n    }\n\n    export function wrap(f: ComplexFunction): ComplexMethod {\n        return function() { return f(this); }\n    }\n}\n\n/**\n * Get a value from a specified object or `undefined` if the key is not present.\n * @param o object\n * @param k key to get\n * @returns value (or `undefined` if not present)\n */\nfunction getFrom<O>(o: O, k: string): O[keyof O] | void {\n    if (k in o) return (o as any)[k];\n}\n\n/**\n * Check if the symbol is in one of the symbol mappings\n * @param n Symbol node to look up\n * @returns the lookup result or an error if not present\n */\nfunction lookup(n: math.SymbolNode): LookupResult {\n    let { name } = n;\n\n    name = name.toLowerCase();\n    if (name === \"z\") return { type: \"z\" };\n\n    if (ComplexMethod.isMethod(name)) return { type: \"method\", f: ComplexMethod.get(name) }\n    if (name in constants) return {\n        type: \"constant\", \n        value: constants[name as keyof typeof constants]\n    }\n    if (name in functions) return {\n        type: \"method\",\n        f: functions[name]\n    }\n\n    throw new Error(`Unrecognized symbol [${name}]`)\n}\n\n/**\n * Take a `FoldResult` object and evaluate it with the specified z-value\n * @param val the `FoldResult`\n * @param z value z should be set to\n * @returns the resulting value\n */\nfunction unwrap(val: FoldResult, z: Complex): Numeric {\n    if (val.type === \"constant\") return val.value;\n    if (val.type === \"function\") return val.f(z);\n    if (val.type === \"z\") return z;\n\n    let _: never = val;\n    throw new Error(`Unrecognized fold result ${(val as any).type}`);\n}\n\nfunction createFunction(\n    f: ComplexMethod<any>, \n    args: math.MathNode[]\n): FoldResult {\n    let fargs = args.map(node => fold(node));\n\n    // if all constants, this can be computed as a constant\n    if (fargs.every((a): a is Results.Constant => a.type === \"constant\")) {\n        const [self, ...rest] = fargs.map(c => c.value);\n\n        const cself = Complex(self);\n        return { type: \"constant\", value: f.apply(cself, rest) };\n    }\n\n    const [self, ...rest] = fargs;\n    \n    return {\n        type: \"function\",\n        f: z => {\n            let a = Complex(unwrap(self, z));\n            let b = rest.map(arg => unwrap(arg, z));\n\n            return f.apply(a, b);\n        }\n    };\n}\n\n/**\n * Fold a node into a usable function\n * @param n Node to fold\n * @returns Function representing the tree\n */\nfunction fold(n: math.MathNode): FoldResult {\n    switch (n.type) {\n        case \"ConstantNode\":\n            return { type: \"constant\", value: n.value };\n        case \"FunctionNode\": {\n            const lk = lookup(n.fn);\n\n            if (lk.type === \"method\") {\n                return createFunction(lk.f, n.args);\n            } else if (lk.type === \"constant\") {\n                throw new Error(`Expected function, got constant [${n.fn.name} = ${lk.value}]`);\n            } else if (lk.type === \"z\") {\n                throw new Error(`Expected function, got [z]`);\n            }\n\n            let _: never = lk;\n            throw new Error(`Expected function, got [${(lk as any).type}]`);\n        }\n        case \"OperatorNode\": {\n            const op = getFrom(operators, n.fn);\n            const f = op ? createFunction(op, n.args) : undefined;\n\n            if (typeof f === \"undefined\") throw new Error(`Unexpected operator [${n.op}]`);\n            return f;\n        }\n        case \"ParenthesisNode\":\n            return fold(n.content);\n        case \"SymbolNode\": {\n            const lk = lookup(n);\n\n            // bare symbols cannot evaluate to methods.\n            if (lk.type === \"method\") {\n                throw new Error(`Unexpected function [${n.name}]`);\n            }\n\n            return lk;\n        }\n        default:\n            throw new Error(`Cannot parse [${n.type}] into complex function`);\n    }\n}\n\n/**\n * Compile a function string into a usable function\n * @param fstr string to compile\n * @returns the function\n */\nexport function compile(fstr: string): Evaluator[\"evaluator\"] {\n    const fr = fold(math.parse(fstr));\n\n    switch (fr.type) {\n        case \"constant\":\n            return {\n                type: \"constant\",\n                f: fr.value,\n            }\n        case \"function\":\n            return fr\n        case \"z\":\n            return {\n                type: \"function\",\n                f: z => z\n            }\n        default:\n            let _: never = fr;\n            throw new Error(`Invalid fold result type ${(fr as any).type}`);\n    }\n}","import { create, all, number } from \"mathjs\";\nimport { Complex, ComplexFunction, InitIn, InitOut, LoaderOut, MainIn, MainOut, PartialEvaluator } from \"./types\";\nimport * as evaluator from \"./evaluator\";\nconst math = create(all);\n\nconst wrapper        = document.querySelector<HTMLDivElement>('div#wrapper')!,\n      controls       = document.querySelector<HTMLDivElement>('div#controls')!,\n      funcInput      = document.querySelector<HTMLInputElement>('input#func-input')!,\n      graphButton    = document.querySelector<HTMLButtonElement>('#graph-button')!,\n      graphStatus    = document.querySelector<HTMLDivElement>('div#graph-status')!,\n      zWrapperItems  = document.querySelectorAll<HTMLElement>('div#z-wrapper code')!,\n      zoomButtons    = document.querySelectorAll<HTMLButtonElement>('button.zoom'),\n      zoomInput      = document.querySelector<HTMLInputElement>('input#zoom-input')!,\n      centerInputs   = document.querySelectorAll<HTMLInputElement>(\"input.center-input\"),\n      recenterButton = document.querySelector<HTMLButtonElement>(\"button#recenter-button\")!,\n      homeButton     = document.querySelector<HTMLButtonElement>(\"button#home-button\")!,\n      domain         = document.querySelectorAll<HTMLElement>('.domain');\n\nconst canvas = document.createElement(\"canvas\");\nconst ctx = canvas.getContext('2d', {alpha: false})!;\n\nwrapper.appendChild(canvas);\n\nasync function updateCanvasDims() {\n    await waitPageUpdate();\n    const { width, height } = canvas.getBoundingClientRect();\n    setProperty(canvas, \"width\",  Math.trunc(width));\n    setProperty(canvas, \"height\", Math.trunc(height));\n    ctx.globalCompositeOperation = \"copy\";\n\n    updateDomain();\n}\nupdateCanvasDims();\n\nconst bufCanvas = document.createElement(\"canvas\");\nconst bctx = bufCanvas.getContext('2d', {alpha: false})!;\n\nnamespace Buffer {\n    const bufProps = {\n        refs: 0,\n        mat: math.identity(3) as math.Matrix,\n    };\n\n    /**\n     * Obtain a reference to the buffer.\n     * If this is the first reference, then the canvas is also copied into the buffer.\n     */\n    export function prepare() {\n        if (!bufProps.refs) {\n            bufCanvas.width = canvas.width;\n            bufCanvas.height = canvas.height;\n            bctx.globalCompositeOperation = \"copy\";\n            bctx.imageSmoothingEnabled = false;\n            bctx.drawImage(canvas, 0, 0);\n\n            bufProps.mat = math.identity(3) as any;\n        }\n        bufProps.refs++;\n    }\n\n    /**\n     * Let go of the reference to the buffer.\n     */\n    export function release() {\n        bufProps.refs = Math.max(bufProps.refs - 1, 0);\n    }\n\n    /**\n     * Obtain a reference to the buffer, do something with it, then release the reference.\n     * @param f Actions to do. \n     * This callback includes an `owner` parameter that specifies \n     * if this was the first reference to the buffer.\n     * @param drawIfOwner If the borrower is actually the owner, should the buffer be drawn?\n     */\n    export function borrow(f: (owner: boolean) => any, drawIfOwner: boolean = true) {\n        const owner = bufProps.refs === 0;\n\n        prepare();\n        f(owner);\n        if (drawIfOwner && owner) draw();\n        release();\n    }\n\n    /**\n     * Draw the buffer onto the main canvas.\n     */\n    export function draw() {\n        if (bufProps.refs) {\n            const { mat } = bufProps;\n\n            abortGraph();\n            ctx.setTransform(\n                mat.get([0, 0]),\n                mat.get([1, 0]),\n                mat.get([0, 1]),\n                mat.get([1, 1]),\n                mat.get([0, 2]),\n                mat.get([1, 2]),\n            )\n            ctx.drawImage(bufCanvas, 0, 0);\n            ctx.resetTransform();\n        }\n    }\n\n    /**\n     * Add a translation to the buffer.\n     * @param dx \n     * @param dy \n     */\n    export function translate(dx: number, dy: number) {\n        bufProps.mat = math.multiply(\n            math.matrix([\n                [1, 0, dx],\n                [0, 1, dy],\n                [0, 0,  1],\n            ]),\n            bufProps.mat\n        );\n    }\n\n    /**\n     * Add a scale to the buffer.\n     * @param scale \n     * @param center Center to scale around\n     */\n    export function scaleAround(scale: number, center?: [number, number]) {\n        const [dx, dy] = center ?? [(canvas.width - 1) / 2, (canvas.height - 1) / 2];\n\n        bufProps.mat = math.chain(\n            math.matrix([\n                [1, 0, dx],\n                [0, 1, dy],\n                [0, 0,  1],\n            ]),\n        ).multiply(\n            math.matrix([\n                [1 / scale,         0, 0],\n                [        0, 1 / scale, 0],\n                [        0,         0, 1],\n            ]),\n        ).multiply(\n            math.matrix([\n                [1, 0, -dx],\n                [0, 1, -dy],\n                [0, 0,   1],\n            ]),\n        ).multiply(\n            bufProps.mat\n        ).done();\n    }\n}\n\nlet center = Complex.ZERO;\n\nfunction setCenter(c: Complex, bufSettings?: { updateBuffer: boolean }) {\n    if (bufSettings?.updateBuffer ?? true) Buffer.borrow(() => {\n        // If the center moves from (a + bi) to (0, 0), the image shifted right.\n        // So, actually you need to translate the buffer (a + bi).\n\n        const dz = center.sub(c);\n        const displace = Convert.toCanvasDisplace(dz);\n        Buffer.translate(...displace);\n    });\n    center = c;\n\n    centerInputs[0].value = `${c.re}`;\n    centerInputs[1].value = `${c.im}`;\n    setHiddenState(recenterButton, c.equals(0, 0));\n    setHiddenState(homeButton, c.equals(0, 0) && scale === 2);\n    \n    updateDomain();\n}\n\n{\n    document.querySelectorAll<HTMLFormElement>(\"#center-controls form\").forEach(f => {\n        f.addEventListener(\"submit\", e => {\n            const re = +centerInputs[0].value;\n            const im = +centerInputs[1].value;\n            const z = Complex(re, im);\n\n            setCenter(z);\n        });\n    });\n    recenterButton.addEventListener(\"click\", e => {\n        setCenter(Complex.ZERO);\n    });\n}\n\n/**\n * Identifier designating the current graph.\n * This is a cyclic value, ranging the entire 32-bit range.\n */\nlet graphID = 0;\n\n/**\n * The scale of the graph represents the distance (in complex units) \n * from the center of the screen to the top.\n */\nlet scale = 2;\n\nfunction setScale(n: number, bufSettings?: { updateBuffer: boolean }) {\n    n = Math.max(n, Number.EPSILON);\n    console.log(n);\n    if (bufSettings?.updateBuffer ?? true) Buffer.borrow(() => {\n        const scaleRatio = n / scale;\n        Buffer.scaleAround(scaleRatio);\n    });\n    scale = n;\n\n    zoomInput.value = `${2 / scale}`;\n    zoomInput.style.width = `${zoomInput.value.length}ch`;\n\n    zoomButtons[1].disabled = scale === 2;\n    \n    setHiddenState(homeButton, center.equals(0, 0) && scale === 2);\n    updateDomain();\n}\n\nfunction addZoom(mouseX: number, mouseY: number, deltaY: number) {\n    // negative = zoom out\n    // positive = zoom in\n\n    const factor = 2 ** (deltaY * 0.005);\n\n    const mousePos = Convert.toComplex(mouseX, mouseY);\n    \n    // in the scaling, the mousePos stays in the same position, \n    // but the distance from the center scales\n    const disp = mousePos.sub(center);\n    \n    Buffer.borrow(() => {\n        setCenter(mousePos.sub(disp.mul(factor)));\n        setScale(scale * factor);\n    });\n    \n}\n\n{\n    const [zoomIn, zoomReset, zoomOut] = zoomButtons;\n\n    zoomIn.addEventListener('click',    () => setScale(scale / 2));\n    zoomReset.addEventListener('click', () => setScale(2));\n    zoomOut.addEventListener('click',   () => setScale(scale * 2));\n}\n\nhomeButton.addEventListener(\"click\", () => {\n    Buffer.borrow(() => {\n        setCenter(Complex.ZERO);\n        setScale(2);\n    });\n});\n\nfunction xyScale() {\n    return [\n        scale * canvas.width / canvas.height,\n        scale,\n    ] as const;\n}\nfunction updateDomain() {\n    const limitDomain = !!+getComputedStyle(document.documentElement)\n        .getPropertyValue(\"--limit-domain\");\n    \n    const [scaleX, scaleY] = xyScale();\n\n    const range = Complex(scaleX, scaleY);\n\n    const cmL = center.sub(range);\n    const cmR = center.add(range);\n\n    if (!limitDomain) {\n        domain[0].textContent = `${cmL}`;\n        domain[1].textContent = `${cmR}`;\n    } else {\n        let { re: lre, im: lim } = cmL;\n        let { re: rre, im: rim } = cmR;\n        \n        const lsign = Math.sign(lim) === -1 ? \"-\" : \"+\";\n        const rsign = Math.sign(lim) === -1 ? \"-\" : \"+\";\n\n        const lreStr = reduceNumber(lre);\n        const rreStr = reduceNumber(rre);\n        const limStr = reduceNumber(Math.abs(lim));\n        const rimStr = reduceNumber(Math.abs(rim));\n\n        domain[0].textContent = `${lreStr} ${lsign} ${limStr}i`;\n        domain[1].textContent = `${rreStr} ${rsign} ${rimStr}i`;\n    }\n}\n\nfunction reduceNumber(n: number) {\n    const s1 = n.toPrecision();\n    const s2 = n.toPrecision(5);\n\n    if (s1.length <= s2.length) return s1;\n    return s2;\n}\n\n/**\n * Function that takes the input complex value to the output one.\n * This is used in the z-coord display.\n * @param z input\n * @returns output\n */\nlet d: ComplexFunction | undefined = (z => z);\n\nlet worker: Worker;\nlet canNest: boolean;\n\n/**\n * On WebKit (iOS), nested Workers are not supported. So this worker tests if they are supported.\n * The result is then used to determine whether or not to use the full main worker or a fallback.\n */\nlet webkitTest = new Worker(new URL(\"./worker/webkitTest\", import.meta.url), {type: \"module\"});\nwebkitTest.postMessage(undefined);\nwebkitTest.onmessage = async function (e: MessageEvent<boolean>) {\n    graphStatus.textContent = \"Initializing workers...\";\n    await waitPageUpdate();\n    canNest = e.data;\n\n    worker = canNest \n        ? new Worker(new URL(\"./worker/main\", import.meta.url), {type: \"module\"}) \n        : new Worker(new URL(\"./worker/chunkLoader\", import.meta.url), {type: \"module\"});\n    \n    await initWorker(worker);\n\n    worker.onmessage = function (e: MessageEvent<MainOut>) {\n        let msg: MainOut = e.data;\n        if (msg.graphID !== graphID) return;\n    \n        if (msg.action === \"chunkDone\") {\n            displayChunk(msg);\n        } else if (msg.action === \"done\") {\n            markDone(msg.time);\n        } else {\n            let _: never = msg;\n        }\n    }\n    \n    worker.onerror = onComputeError;\n    graphButton.disabled = false;\n    webkitTest.terminate();\n\n    document.querySelectorAll(\".initializing\").forEach(e => e.classList.remove(\"initializing\"));\n    graph(); // Don't need to await it. We just want it to happen eventually.\n}\n\n/**\n * Calculate complex coordinates from the current mouse position\n */\nfunction fromMousePosition({pageX, pageY}: {pageX: number, pageY: number}) {\n    const x = pageX - canvas.offsetLeft;\n    const y = pageY - canvas.offsetTop;\n\n    const { width, height } = canvas.getBoundingClientRect();\n    if ( x < 0 || x >= width  ) return;\n    if ( y < 0 || y >= height ) return;\n\n    return Convert.toComplex(x, y);\n}\n\n{\n    let holds = new Map<number, {\n        initX: number,\n        initY: number,\n        lastX: number,\n        lastY: number\n    }>();\n    \n    canvas.addEventListener('pointerdown', e => {\n        console.log(\"pointerdown\", e.pointerId);\n\n        let initX, initY, lastX, lastY;\n        lastX = initX = e.clientX;\n        lastY = initY = e.clientY;\n        holds.set(e.pointerId, {initX, initY, lastX, lastY});\n\n        Buffer.prepare();\n    });\n\n    function pointerup(e: PointerEvent) {\n        const pos = holds.get(e.pointerId);\n\n        if (holds.delete(e.pointerId)) {\n            Buffer.release();\n        }\n\n        if (holds.size === 0 && pos) {\n            // if any displacement occurred, then redraw\n            const [dx, dy] = [\n                e.clientX - pos.initX,\n                e.clientY - pos.initY\n            ]\n    \n            if (dx !== 0 || dy !== 0) graph();\n        }\n    }\n\n    document.addEventListener('pointerup', pointerup);\n    document.addEventListener('pointercancel', pointerup);\n\n    function distance(pts: (readonly [x: number, y: number])[]): [center: readonly [x: number, y: number], dist: number] {\n        const length = pts.length;\n        const [scx, scy] = pts.reduce(([ax, ay], [cx, cy]) => [ax + cx, ay + cy] as const);\n        \n        const center = [scx / length, scy / length] as const;\n        const [cx, cy] = center;\n\n        const distances = pts.map(([x, y]) => Math.hypot(x - cx, y - cy));\n        const totalDistance = distances.reduce((acc, cv) => acc + cv);\n\n        return [center, totalDistance];\n    }\n\n    document.addEventListener('pointermove', e => {\n        console.log(\"pointermove\", e.pointerId);\n        \n        const pos = holds.get(e.pointerId);\n        if (pos) {\n            if (holds.size === 1) {\n                const [dx, dy] = [\n                    e.clientX - pos.lastX,\n                    e.clientY - pos.lastY\n                ]\n    \n                const dz = Convert.toComplexDisplace(dx, dy);\n                setCenter(center.sub(dz));\n                Buffer.draw();\n    \n                pos.lastX = e.clientX;\n                pos.lastY = e.clientY;\n            } else {\n                let positions = Array.from(holds.values(), ({lastX, lastY}) => [lastX, lastY] as const);\n                const [_, d1] = distance(positions);\n\n                pos.lastX = e.clientX;\n                pos.lastY = e.clientY;\n\n                positions = Array.from(holds.values(), ({lastX, lastY}) => [lastX, lastY] as const);\n                const [c, d2] = distance(positions);\n\n                addZoom(...c, d1 - d2);\n                Buffer.draw();\n            }\n        }\n    });\n}\n\n{\n    let timeout: NodeJS.Timeout;\n    let started = false;\n\n    canvas.addEventListener(\"wheel\", e => {\n        e.preventDefault();\n        clearTimeout(timeout);\n\n        if (!started) {\n            started = true;\n            // wheel start\n\n            Buffer.prepare();\n        }\n        \n\n        // wheel move\n        if (e.ctrlKey) {\n            addZoom(e.clientX, e.clientY, e.deltaY);\n            Buffer.draw();\n        } else {\n            const dx = e.deltaX * .5;\n            const dy = e.deltaY * .5;\n\n            const dz = Convert.toComplexDisplace(dx, dy);\n            setCenter(center.sub(dz));\n            Buffer.draw();\n        }\n        \n        coordinateDisplay(e);\n\n        timeout = setTimeout(() => {\n            // wheel end\n            graph();\n            Buffer.release();\n            started = false;\n        }, 500);\n    }, false);\n}\n\n/**\n * Event listener that displays the complex coordinate of the mouse's current position.\n */\nasync function coordinateDisplay(...args: Parameters<typeof fromMousePosition>) {\n    const pos = fromMousePosition(...args);\n\n    if (typeof pos !== \"undefined\") {\n        const [zElem, fzElem] = zWrapperItems;\n        \n        zElem.textContent  = `${pos}`;\n        fzElem.textContent = `${d?.(pos) ?? \"?\"}`;\n    }\n};\ncanvas.addEventListener('mousemove', coordinateDisplay);\ncontrols.addEventListener('mousemove', coordinateDisplay);\ndocument.addEventListener(\"click\", coordinateDisplay);\n\n// Function input handlers:\n// funcInput.addEventListener('input', () => {\n//     funcInput.value = funcInput.value.replace(/[^a-zA-Z0-9+\\-*/^., ()!]/g, '');\n// });\n\nlet resizeCheck: NodeJS.Timer | undefined;\nwindow.addEventListener(\"resize\", e => {\n    if (typeof resizeCheck !== \"undefined\") clearTimeout(resizeCheck);\n    // if resize is done then perform recompute\n    resizeCheck = setTimeout(async () => await graph(), 200);\n});\n\ndocument.querySelector<HTMLFormElement>(\"form#zoom-form\")!.addEventListener(\"submit\", () => {\n    if (zoomInput.checkValidity()) setScale(2 / +zoomInput.value);\n});\n\n// For things that unconditionally graph after being pressed:\ndocument.querySelectorAll<HTMLFormElement>(\"form.graph-submit\").forEach(f => {\n    f.addEventListener(\"submit\", e => {\n        e.preventDefault();\n        graph();\n    });\n});\ndocument.querySelectorAll<HTMLButtonElement>(\"button.graph-submit\").forEach(b => {\n    b.addEventListener(\"click\", () => {\n        graph();\n    });\n});\n\nasync function graph() {\n    if (graphButton.disabled) return;\n\n    graphStatus.classList.remove(\"hidden\", \"error\", \"done\");\n    graphStatus.textContent = 'Graphing...'\n\n    await updateCanvasDims();\n    await waitPageUpdate();\n    \n    let fstr = funcInput.value;\n    try {\n        const eva = evaluator.compile(fstr);\n        if (eva.type === \"function\") d = eva.f;\n        else d = () => eva.f;\n\n        startWorker(worker, fstr);\n    } catch (e) {\n        onComputeError(e as any);\n        throw e;\n    }\n}\n\n/**\n * @returns a promise that resolves when the DOM updates displaying\n */\nasync function waitPageUpdate() {\n    return new Promise<void>(resolve => {\n        requestAnimationFrame(() => { // this is called before update\n            requestAnimationFrame(() => resolve()); // this is called after update\n        });\n    })\n}\n\nnamespace Convert {\n    /**\n     * Converts a canvas position to a complex position\n     * @param x x (in canvas pixels)\n     * @param y y (in canvas pixels)\n     * @returns the complex position\n     */\n    export function toComplex(x: number, y: number) {\n        const [canvasCenterX, canvasCenterY] = [\n            (canvas.width  - 1) / 2,\n            (canvas.height - 1) / 2\n        ];\n\n        const dz = toComplexDisplace(\n            x - canvasCenterX,\n            y - canvasCenterY\n        );\n        return center.add(dz);\n    }\n\n    /**\n     * Converts canvas displacement to complex displacement\n     * @param dx change in x (in canvas pixels)\n     * @param dy change in y (in canvas pixels)\n     * @returns complex displacement\n     */\n    export function toComplexDisplace(dx: number, dy: number) {\n        const { width, height } = canvas;\n        const [scaleX, scaleY] = xyScale();\n    \n        // 1 unit of scale\n        const [unitX, unitY] = [\n             (width  - 1) / 2,\n            -(height - 1) / 2\n        ];\n    \n        return Complex(dx * scaleX / unitX, dy * scaleY / unitY);\n    }\n\n    /**\n     * Converts a complex position to a canvas position\n     * @param z the complex position\n     * @returns the canvas position\n     */\n    export function toCanvas(z: Complex): [x: number, y: number] {\n        const [canvasCenterX, canvasCenterY] = [\n            (canvas.width  - 1) / 2,\n            (canvas.height - 1) / 2\n        ];\n\n        const dz = z.sub(center);\n        const [dx, dy] = toCanvasDisplace(dz);\n\n        return [canvasCenterX + dx, canvasCenterY + dy];\n    }\n\n    /**\n     * Converts complex displacement to canvas displacement\n     * @param dz complex displacement\n     * @returns canvas displacement\n     */\n    export function toCanvasDisplace(dz: Complex): [dx: number, dy: number] {\n        const { width, height } = canvas;\n        const [scaleX, scaleY] = xyScale();\n    \n        // 1 unit of scale\n        const [unitX, unitY] = [\n             (width  - 1) / 2,\n            -(height - 1) / 2\n        ];\n\n        return [dz.re * unitX / scaleX, dz.im * unitY / scaleY];\n    }\n}\n\n/**\n * Call an \"init\" action on a worker to prepare it for work.\n * @param w Worker to initialize.\n * @returns promise that resolves once it finishes initialization.\n */\nasync function initWorker(w: Worker) {\n    let init: InitIn = { action: \"init\" };\n    w.postMessage(init);\n\n    return new Promise<void>(resolve => {\n        w.onmessage = function(e: MessageEvent<InitOut>) {\n            resolve();\n        }\n    });\n}\n\n/**\n * Instruct the worker to begin processing a function.\n * @param w the worker to instruct.\n * @param fstr the function input\n */\nfunction startWorker(w: Worker, fstr: string) {\n    graphID++;\n    graphID |= 0;\n    \n    let msg: MainIn = {\n        action: \"mainRequest\",\n        pev: partialEvaluate(fstr), \n        cd: {\n            width: canvas.width,\n            height: canvas.height,\n            center: [center.re, center.im],\n            scale,\n        },\n        graphID\n    };\n    w.postMessage(msg);\n}\n\nfunction abortGraph() {\n    graphID++;\n    graphID |= 0;\n}\n\n/**\n * Update the canvas with the loaded chunk\n * @param data the data from the worker\n */\n function displayChunk(data: LoaderOut) {\n    let {chunk, buf} = data;\n\n    let dat = new ImageData(new Uint8ClampedArray(buf), chunk.width, chunk.height);\n    ctx.putImageData(dat, chunk.offx, chunk.offy);\n}\n\n/**\n * Take a string and evaluate it for speed. Simplify the string and also apply the reciprocal optimization.\n * This partial evaluation can then be fully evaluated in the workers.\n * @param fstr string to partially evaluate\n * @returns partially evaluated string\n */\nfunction partialEvaluate(fstr: string): PartialEvaluator {\n    let node = math.simplify(fstr);\n\n    let inverse = false;\n    if (node.type == \"OperatorNode\" && node.fn == 'divide' && !isNaN(+node.args[0])) { // reciprocal func\n        node.args.reverse();\n        node = math.simplify(node);\n        inverse = true;\n    }\n\n    return { fstr: node.toString(), inverse };\n}\n\n/**\n * Display a done message with how long it took to complete\n * @param t time (in ms) it took for the operation to complete\n */\nasync function markDone(t: number) {\n    graphStatus.textContent = `Done in ${t}ms.`;\n    graphStatus.classList.add(\"done\");\n    \n    await waitPageUpdate();\n    clearStatusAfter();\n}\n\n/**\n * Handle errors in computation\n * @param e the error\n */\nfunction onComputeError(e: Error | ErrorEvent) {\n    let err = e instanceof ErrorEvent ? e.message : e;\n\n    graphStatus.classList.add('error');\n    graphStatus.textContent = String(err);\n}\n\n/**\n * Reset the status after a while.\n * @param after how many ms before status should be cleared.\n */\nfunction clearStatusAfter(after = 1000) {\n    setTimeout(() => {\n        if (graphStatus.classList.contains(\"done\")) {\n            graphStatus.classList.remove(\"done\");\n            graphStatus.classList.add(\"hidden\");\n        }\n    }, after);\n}\n\nfunction setProperty<P extends string | number | symbol, V>(o: {[I in P]: V}, p: P, v: V) {\n    if (o[p] !== v) o[p] = v;\n}\n\nfunction setHiddenState(b: HTMLElement, status: boolean) {\n    b.classList.toggle(\"hidden\", status);\n    if (b instanceof HTMLButtonElement) b.disabled = status;\n}","\"use strict\";\n\nmodule.exports = function (workerUrl, origin, isESM) {\n  if (origin === self.location.origin) {\n    // If the worker bundle's url is on the same origin as the document,\n    // use the worker bundle's own url.\n    return workerUrl;\n  } else {\n    // Otherwise, create a blob URL which loads the worker bundle with `importScripts`.\n    var source = isESM ? 'import ' + JSON.stringify(workerUrl) + ';' : 'importScripts(' + JSON.stringify(workerUrl) + ');';\n    return URL.createObjectURL(new Blob([source], {\n      type: 'application/javascript'\n    }));\n  }\n};","let workerURL = require('./helpers/get-worker-url');\nlet bundleURL = require('./helpers/bundle-url');\nlet url = bundleURL.getBundleURL('5Hjnn') + require('./helpers/bundle-manifest').resolve(\"dq1cl\");module.exports = workerURL(url, bundleURL.getOrigin(url), false);","let workerURL = require('./helpers/get-worker-url');\nlet bundleURL = require('./helpers/bundle-url');\nlet url = bundleURL.getBundleURL('5Hjnn') + require('./helpers/bundle-manifest').resolve(\"egthy\");module.exports = workerURL(url, bundleURL.getOrigin(url), false);","let workerURL = require('./helpers/get-worker-url');\nlet bundleURL = require('./helpers/bundle-url');\nlet url = bundleURL.getBundleURL('5Hjnn') + require('./helpers/bundle-manifest').resolve(\"ainsM\");module.exports = workerURL(url, bundleURL.getOrigin(url), false);"],"names":["$3e5ab7acf35dfd5a$var$asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","$3e5ab7acf35dfd5a$export$2e2bcd8739ae039","fn","self","this","args","arguments","apply","err","undefined","$692ff81777bc7261$export$6503ec6e8aabbaf","$692ff81777bc7261$export$f7ad0328861e2f03","$692ff81777bc7261$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","$b896bd97a2fc8cb8$export$bdfd709ae4826697","$b896bd97a2fc8cb8$export$5a759dc7a1cfb72a","$b896bd97a2fc8cb8$var$bundleURL","$b896bd97a2fc8cb8$var$getBaseURL","url","replace","matches","stack","match","$b896bd97a2fc8cb8$var$getBundleURL","parcelRequire","register","JSON","parse","$fADtK","$7r89I","$4bbc5b28a7831ffc$export$2e2bcd8739ae039","arr","default","$aJpC9","$c7aA8","$d2MH1","$688aeae1d103f679$var$ComplexMethod","$688aeae1d103f679$var$math","$b3Rbn","create","all","$688aeae1d103f679$var$constants","pi","Complex","PI","e","E","I","inf","INFINITY","infinity","epsilon","EPSILON","nan","NAN","$688aeae1d103f679$var$functions","gamma","ln","prototype","log","$688aeae1d103f679$var$operators","add","unaryPlus","subtract","sub","unaryMinus","neg","multiply","mul","divide","div","pow","factorial","$688aeae1d103f679$var$lookup","n","name","toLowerCase","type","isMethod","f","get","concat","$688aeae1d103f679$var$unwrap","val","z","$688aeae1d103f679$var$createFunction","fargs","map","node","$688aeae1d103f679$var$fold","every","a","ref","c","rest","slice","cself","_fargs","self1","rest1","b","lk","op","o","k","$688aeae1d103f679$var$getFrom","content","lk1","$688aeae1d103f679$export$ef7acd7185315e22","fstr","fr","m","Function","wrap","$a1c2e7b6e24fd632$var$math","$a1c2e7b6e24fd632$var$wrapper","document","querySelector","$a1c2e7b6e24fd632$var$controls","$a1c2e7b6e24fd632$var$funcInput","$a1c2e7b6e24fd632$var$graphButton","$a1c2e7b6e24fd632$var$graphStatus","$a1c2e7b6e24fd632$var$zWrapperItems","querySelectorAll","$a1c2e7b6e24fd632$var$zoomButtons","$a1c2e7b6e24fd632$var$zoomInput","$a1c2e7b6e24fd632$var$centerInputs","$a1c2e7b6e24fd632$var$recenterButton","$a1c2e7b6e24fd632$var$homeButton","$a1c2e7b6e24fd632$var$domain","$a1c2e7b6e24fd632$var$canvas","createElement","$a1c2e7b6e24fd632$var$ctx","getContext","alpha","$a1c2e7b6e24fd632$var$updateCanvasDims","$a1c2e7b6e24fd632$var$_updateCanvasDims","$parcel$interopDefault","$isjeC","mark","_callee","width","height","$a1c2e7b6e24fd632$var$waitPageUpdate","getBoundingClientRect","$a1c2e7b6e24fd632$var$setProperty","Math","trunc","globalCompositeOperation","$a1c2e7b6e24fd632$var$updateDomain","appendChild","$a1c2e7b6e24fd632$var$Buffer","prepare","release","draw","bufProps","$a1c2e7b6e24fd632$var$bufCanvas","$a1c2e7b6e24fd632$var$bctx","refs","imageSmoothingEnabled","drawImage","mat","identity","max","$a1c2e7b6e24fd632$var$graphID","setTransform","resetTransform","borrow","drawIfOwner","owner","translate","dx","dy","matrix","scaleAround","scale1","center1","$i4pIp","chain","$a1c2e7b6e24fd632$var$center","ZERO","$a1c2e7b6e24fd632$var$setCenter","bufSettings","updateBuffer","_Buffer","dz","displace","$a1c2e7b6e24fd632$var$Convert","toCanvasDisplace","$e9mLB","re","im","$a1c2e7b6e24fd632$var$setHiddenState","equals","$a1c2e7b6e24fd632$var$scale","forEach","addEventListener","$a1c2e7b6e24fd632$var$setScale","Number","console","scaleRatio","style","disabled","$a1c2e7b6e24fd632$var$addZoom","mouseX","mouseY","deltaY","factor","mousePos","toComplex","disp","$a1c2e7b6e24fd632$var$_zoomButtons","$a1c2e7b6e24fd632$var$zoomIn","$a1c2e7b6e24fd632$var$zoomReset","$a1c2e7b6e24fd632$var$zoomOut","$a1c2e7b6e24fd632$var$xyScale","limitDomain","getComputedStyle","documentElement","getPropertyValue","scaleX","scaleY","range","cmL","cmR","lre","lim","rre","rim","lsign","sign","rsign","lreStr","$a1c2e7b6e24fd632$var$reduceNumber","rreStr","limStr","abs","rimStr","textContent","s1","toPrecision","s2","$a1c2e7b6e24fd632$var$worker","$a1c2e7b6e24fd632$var$canNest","$a1c2e7b6e24fd632$var$d","$5afb424d5d25c1fb$exports","workerUrl","origin","isESM","location","source","stringify","URL","createObjectURL","Blob","$0c04cab1b8fef68e$var$url","getBundleURL","$0c04cab1b8fef68e$exports","$fQyQn","getOrigin","$a1c2e7b6e24fd632$var$webkitTest","Worker","postMessage","$6a16b0a078527ef0$var$url","$6a16b0a078527ef0$exports","$583af9a5a69abdc7$var$url","$a1c2e7b6e24fd632$var$fromMousePosition","param","pageX","pageY","x","offsetLeft","y","offsetTop","$583af9a5a69abdc7$exports","onmessage","e1","data","$a1c2e7b6e24fd632$var$initWorker","chunk","buf","dat","msg","graphID","action","ImageData","Uint8ClampedArray","putImageData","offx","offy","$a1c2e7b6e24fd632$var$markDone","time","onerror","$a1c2e7b6e24fd632$var$onComputeError","terminate","classList","remove","$a1c2e7b6e24fd632$var$graph","$a1c2e7b6e24fd632$var$pointerup","pos","$a1c2e7b6e24fd632$var$holds","pointerId","delete","size","clientX","initX","clientY","initY","$a1c2e7b6e24fd632$var$distance","pts","reduce","param1","ax","_param","ay","_param1","center2","_center","cx1","cy1","hypot","acc","cv","Map","lastX","lastY","set","toComplexDisplace","positions","Array","from","values","ref1","d1","ref2","d2","$a1c2e7b6e24fd632$var$timeout","$a1c2e7b6e24fd632$var$resizeCheck","$a1c2e7b6e24fd632$var$started","$a1c2e7b6e24fd632$var$coordinateDisplay","$a1c2e7b6e24fd632$var$_coordinateDisplay","_len","_key","_zWrapperItems","zElem","fzElem","_args","$a1c2e7b6e24fd632$var$_graph","eva","$a1c2e7b6e24fd632$var$startWorker","_ctx","t0","$a1c2e7b6e24fd632$var$_waitPageUpdate","requestAnimationFrame","w","$a1c2e7b6e24fd632$var$_initWorker","init","pev","$a1c2e7b6e24fd632$var$partialEvaluate","cd","center","scale","simplify","inverse","isNaN","reverse","toString","t","$a1c2e7b6e24fd632$var$_markDone","$a1c2e7b6e24fd632$var$clearStatusAfter","ErrorEvent","message","String","after","setTimeout","contains","p","v","status","toggle","HTMLButtonElement","preventDefault","clearTimeout","ctrlKey","deltaX","window","checkValidity","ref3","unitX","unitY","ref5","toCanvas","canvasCenterX","canvasCenterY","ref4"],"version":3,"file":"complexgrapher.2cd5a0d0.js.map"}