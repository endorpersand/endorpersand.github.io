!function(){function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}function e(t){return t&&t.__esModule?t.default:t}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},o={},a=n.parcelRequire94c2;function u(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,o)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){u(i,r,o,a,c,"next",t)}function c(t){u(i,r,o,a,c,"throw",t)}a(void 0)}))}}null==a&&((a=function(t){if(t in r)return r[t].exports;if(t in o){var e=o[t];delete o[t];var n={id:t,exports:{}};return r[t]=n,e.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(t,e){o[t]=e},n.parcelRequire94c2=a),a.register("91UpR",(function(e,n){var r,o;t(e.exports,"register",(function(){return r}),(function(t){return r=t})),t(e.exports,"resolve",(function(){return o}),(function(t){return o=t}));var i={};r=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)i[e[n]]=t[e[n]]},o=function(t){var e=i[t];if(null==e)throw new Error("Could not resolve bundle with id "+t);return e}})),a.register("fQyQn",(function(e,n){var r,o;t(e.exports,"getBundleURL",(function(){return r}),(function(t){return r=t})),t(e.exports,"getOrigin",(function(){return o}),(function(t){return o=t}));var i={};function a(t){return(""+t).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}r=function(t){var e=i[t];return e||(e=function(){try{throw new Error}catch(e){var t=(""+e.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(t)return a(t[2])}return"/"}(),i[t]=e),e},o=function(t){var e=(""+t).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^/]+/);if(!e)throw new Error("Origin not found");return e[0]}})),a("91UpR").register(JSON.parse('{"5Hjnn":"complexgrapher.2cd5a0d0.js","dq1cl":"webkitTest.5c78f70c.js","egthy":"main.edf03ce0.js","1GZwD":"main.66bf90c5.js","ainsM":"chunkloader.35421398.js","bumwR":"chunkloader.6b4af37c.js","aUCA8":"complexgrapher.76607184.js","33yRb":"complexgrapher.803d8665.js"}'));var l=a("i4pIp"),s=a("e9mLB"),f=a("isjeC"),p=a("b3Rbn"),d=a("fADtK"),m=(a("fADtK"),a("7r89I")),v=a("aJpC9"),h=a("d2MH1"),g=a("c7aA8");function y(t){return(0,m.default)(t)||(0,v.default)(t)||(0,g.default)(t,i)||(0,h.default)()}p=a("b3Rbn"),d=a("fADtK");var w,x,b=(0,p.create)(p.all),C={pi:d.Complex.PI,e:d.Complex.E,i:d.Complex.I,inf:d.Complex.INFINITY,infinity:d.Complex.INFINITY,epsilon:d.Complex.EPSILON,nan:d.Complex.NAN},E={gamma:function(){return b.gamma(this)},ln:d.Complex.prototype.log},L={add:d.Complex.prototype.add,unaryPlus:function(){return this},subtract:d.Complex.prototype.sub,unaryMinus:d.Complex.prototype.neg,multiply:d.Complex.prototype.mul,divide:d.Complex.prototype.div,pow:d.Complex.prototype.pow,factorial:function(){return b.gamma(this.add(1))}};function S(t){var e=t.name;if("z"===(e=e.toLowerCase()))return{type:"z"};if(w.isMethod(e))return{type:"method",f:w.get(e)};if(e in C)return{type:"constant",value:C[e]};if(e in E)return{type:"method",f:E[e]};throw new Error("Unrecognized symbol [".concat(e,"]"))}function R(t,e){if("constant"===t.type)return t.value;if("function"===t.type)return t.f(e);if("z"===t.type)return e;throw new Error("Unrecognized fold result ".concat(t.type))}function A(t,e){var n=e.map((function(t){return k(t)}));if(n.every((function(t){return"constant"===t.type}))){var r=y(n.map((function(t){return t.value}))),o=r[0],i=r.slice(1),a=(0,d.Complex)(o);return{type:"constant",value:t.apply(a,i)}}var u=y(n),c=u[0],l=u.slice(1);return{type:"function",f:function(e){var n=(0,d.Complex)(R(c,e)),r=l.map((function(t){return R(t,e)}));return t.apply(n,r)}}}function k(t){switch(t.type){case"ConstantNode":return{type:"constant",value:t.value};case"FunctionNode":var e=S(t.fn);if("method"===e.type)return A(e.f,t.args);if("constant"===e.type)throw new Error("Expected function, got constant [".concat(t.fn.name," = ").concat(e.value,"]"));if("z"===e.type)throw new Error("Expected function, got [z]");throw new Error("Expected function, got [".concat(e.type,"]"));case"OperatorNode":var n=function(t,e){if(e in t)return t[e]}(L,t.fn),r=n?A(n,t.args):void 0;if(void 0===r)throw new Error("Unexpected operator [".concat(t.op,"]"));return r;case"ParenthesisNode":return k(t.content);case"SymbolNode":var o=S(t);if("method"===o.type)throw new Error("Unexpected function [".concat(t.name,"]"));return o;default:throw new Error("Cannot parse [".concat(t.type,"] into complex function"))}}function q(t){var e=k(b.parse(t));switch(e.type){case"constant":return{type:"constant",f:e.value};case"function":return e;case"z":return{type:"function",f:function(t){return t}};default:throw new Error("Invalid fold result type ".concat(e.type))}}(x=w||(w={})).isMethod=function(t){return t in d.Complex.prototype},x.get=function(t){var e=d.Complex.prototype[t];return e instanceof Function?e:function(){return this[t]}},x.wrap=function(t){return function(){return t(this)}};var I=(0,p.create)(p.all),M=document.querySelector("div#wrapper"),O=document.querySelector("div#controls"),H=document.querySelector("input#func-input"),N=document.querySelector("#graph-button"),z=document.querySelector("div#graph-status"),_=document.querySelectorAll("div#z-wrapper code"),D=document.querySelectorAll("button.zoom"),U=document.querySelector("input#zoom-input"),Y=document.querySelectorAll("input.center-input"),j=document.querySelector("button#recenter-button"),X=document.querySelector("button#home-button"),F=document.querySelectorAll(".domain"),T=document.createElement("canvas"),P=T.getContext("2d",{alpha:!1});function B(){return Q.apply(this,arguments)}function Q(){return(Q=c(e(f).mark((function t(){var n,r,o;return e(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ft();case 2:n=T.getBoundingClientRect(),r=n.width,o=n.height,Vt(T,"width",Math.trunc(r)),Vt(T,"height",Math.trunc(o)),P.globalCompositeOperation="copy",pt();case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}M.appendChild(T),B();var J,K,Z,W,G,V,$=document.createElement("canvas"),tt=$.getContext("2d",{alpha:!1});K=J||(J={}),Z=function(){V.refs||($.width=T.width,$.height=T.height,tt.globalCompositeOperation="copy",tt.imageSmoothingEnabled=!1,tt.drawImage(T,0,0),V.mat=I.identity(3)),V.refs++},W=function(){V.refs=Math.max(V.refs-1,0)},G=function(){if(V.refs){var t=V.mat;rt++,rt|=0,P.setTransform(t.get([0,0]),t.get([1,0]),t.get([0,1]),t.get([1,1]),t.get([0,2]),t.get([1,2])),P.drawImage($,0,0),P.resetTransform()}},V={refs:0,mat:I.identity(3)},K.prepare=Z,K.release=W,K.borrow=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0===V.refs;Z(),t(n),e&&n&&G(),W()},K.draw=G,K.translate=function(t,e){V.mat=I.multiply(I.matrix([[1,0,t],[0,1,e],[0,0,1]]),V.mat)},K.scaleAround=function(t,e){var n=(0,l.default)(null!=e?e:[(T.width-1)/2,(T.height-1)/2],2),r=n[0],o=n[1];V.mat=I.chain(I.matrix([[1,0,r],[0,1,o],[0,0,1]])).multiply(I.matrix([[1/t,0,0],[0,1/t,0],[0,0,1]])).multiply(I.matrix([[1,0,-r],[0,1,-o],[0,0,1]])).multiply(V.mat).done()};var et=d.Complex.ZERO;function nt(t,e){var n;(null===(n=null==e?void 0:e.updateBuffer)||void 0===n||n)&&J.borrow((function(){var e,n=et.sub(t),r=Ht.toCanvasDisplace(n);(e=J).translate.apply(e,(0,s.default)(r))})),et=t,Y[0].value="".concat(t.re),Y[1].value="".concat(t.im),$t(j,t.equals(0,0)),$t(X,t.equals(0,0)&&2===ot),pt()}document.querySelectorAll("#center-controls form").forEach((function(t){t.addEventListener("submit",(function(t){var e=+Y[0].value,n=+Y[1].value;nt((0,d.Complex)(e,n))}))})),j.addEventListener("click",(function(t){nt(d.Complex.ZERO)}));var rt=0,ot=2;function it(t,e){var n;t=Math.max(t,Number.EPSILON),console.log(t),(null===(n=null==e?void 0:e.updateBuffer)||void 0===n||n)&&J.borrow((function(){var e=t/ot;J.scaleAround(e)})),ot=t,U.value="".concat(2/ot),U.style.width="".concat(U.value.length,"ch"),D[1].disabled=2===ot,$t(X,et.equals(0,0)&&2===ot),pt()}function at(t,e,n){var r=Math.pow(2,.005*n),o=Ht.toComplex(t,e),i=o.sub(et);J.borrow((function(){nt(o.sub(i.mul(r))),it(ot*r)}))}var ut=(0,l.default)(D,3),ct=ut[0],lt=ut[1],st=ut[2];function ft(){return[ot*T.width/T.height,ot]}function pt(){var t=!!+getComputedStyle(document.documentElement).getPropertyValue("--limit-domain"),e=(0,l.default)(ft(),2),n=e[0],r=e[1],o=(0,d.Complex)(n,r),i=et.sub(o),a=et.add(o);if(t){var u=i.re,c=i.im,s=a.re,f=a.im,p=-1===Math.sign(c)?"-":"+",m=-1===Math.sign(c)?"-":"+",v=dt(u),h=dt(s),g=dt(Math.abs(c)),y=dt(Math.abs(f));F[0].textContent="".concat(v," ").concat(p," ").concat(g,"i"),F[1].textContent="".concat(h," ").concat(m," ").concat(y,"i")}else F[0].textContent="".concat(i),F[1].textContent="".concat(a)}function dt(t){var e=t.toPrecision(),n=t.toPrecision(5);return e.length<=n.length?e:n}ct.addEventListener("click",(function(){return it(ot/2)})),lt.addEventListener("click",(function(){return it(2)})),st.addEventListener("click",(function(){return it(2*ot)})),X.addEventListener("click",(function(){J.borrow((function(){nt(d.Complex.ZERO),it(2)}))}));var mt,vt,ht,gt,yt=function(t){return t};gt=function(t,e,n){if(e===self.location.origin)return t;var r=n?"import "+JSON.stringify(t)+";":"importScripts("+JSON.stringify(t)+");";return URL.createObjectURL(new Blob([r],{type:"application/javascript"}))};var wt=(Lt=a("fQyQn")).getBundleURL("5Hjnn")+a("91UpR").resolve("dq1cl");ht=gt(wt,Lt.getOrigin(wt),!1);var xt=new Worker(ht);xt.postMessage(void 0);var bt,Ct=(Lt=a("fQyQn")).getBundleURL("5Hjnn")+a("91UpR").resolve("egthy");bt=gt(Ct,Lt.getOrigin(Ct),!1);var Et,Lt,St,Rt=(Lt=a("fQyQn")).getBundleURL("5Hjnn")+a("91UpR").resolve("ainsM");function At(t){var e=t.pageX,n=t.pageY,r=e-T.offsetLeft,o=n-T.offsetTop,i=T.getBoundingClientRect(),a=i.width,u=i.height;if(!(r<0||r>=a||o<0||o>=u))return Ht.toComplex(r,o)}Et=gt(Rt,Lt.getOrigin(Rt),!1),xt.onmessage=(St=c(e(f).mark((function t(n){return e(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return z.textContent="Initializing workers...",t.next=3,Ft();case 3:return vt=n.data,mt=vt?new Worker(bt):new Worker(Et),t.next=7,Pt(mt);case 7:mt.onmessage=function(t){var e,n,r,o,i=t.data;i.graphID===rt&&("chunkDone"===i.action?(n=(e=i).chunk,r=e.buf,o=new ImageData(new Uint8ClampedArray(r),n.width,n.height),P.putImageData(o,n.offx,n.offy)):"done"===i.action&&Kt(i.time))},mt.onerror=Wt,N.disabled=!1,xt.terminate(),document.querySelectorAll(".initializing").forEach((function(t){return t.classList.remove("initializing")})),jt();case 13:case"end":return t.stop()}}),t)}))),function(t){return St.apply(this,arguments)});var kt=function(t){var e=It.get(t.pointerId);if(It.delete(t.pointerId)&&J.release(),0===It.size&&e){var n=[t.clientX-e.initX,t.clientY-e.initY];0===n[0]&&0===n[1]||jt()}},qt=function(t){var e=t.length,n=(0,l.default)(t.reduce((function(t,e){var n=(0,l.default)(t,2),r=n[0],o=n[1],i=(0,l.default)(e,2);return[r+i[0],o+i[1]]})),2),r=[n[0]/e,n[1]/e],o=(0,l.default)(r,2),i=o[0],a=o[1];return[r,t.map((function(t){var e=(0,l.default)(t,2),n=e[0],r=e[1];return Math.hypot(n-i,r-a)})).reduce((function(t,e){return t+e}))]},It=new Map;T.addEventListener("pointerdown",(function(t){var e,n,r,o;console.log("pointerdown",t.pointerId),r=e=t.clientX,o=n=t.clientY,It.set(t.pointerId,{initX:e,initY:n,lastX:r,lastY:o}),J.prepare()})),document.addEventListener("pointerup",kt),document.addEventListener("pointercancel",kt),document.addEventListener("pointermove",(function(t){console.log("pointermove",t.pointerId);var e=It.get(t.pointerId);if(e)if(1===It.size){var n=[t.clientX-e.lastX,t.clientY-e.lastY],r=n[0],o=n[1],i=Ht.toComplexDisplace(r,o);nt(et.sub(i)),J.draw(),e.lastX=t.clientX,e.lastY=t.clientY}else{var a=Array.from(It.values(),(function(t){return[t.lastX,t.lastY]})),u=(0,l.default)(qt(a),2),c=(u[0],u[1]);e.lastX=t.clientX,e.lastY=t.clientY,a=Array.from(It.values(),(function(t){return[t.lastX,t.lastY]}));var f=(0,l.default)(qt(a),2),p=f[0],d=f[1];at.apply(void 0,(0,s.default)(p).concat([c-d])),J.draw()}}));var Mt,Ot,Ht,Nt,zt,_t,Dt=!1;function Ut(){return Yt.apply(this,arguments)}function Yt(){return Yt=c(e(f).mark((function t(){var n,r,o,i,a,u,c,p,d=arguments;return e(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=d.length,r=new Array(n),o=0;o<n;o++)r[o]=d[o];void 0!==(i=At.apply(void 0,(0,s.default)(r)))&&(a=(0,l.default)(_,2),u=a[0],c=a[1],u.textContent="".concat(i),c.textContent="".concat(null!==(p=null==yt?void 0:yt(i))&&void 0!==p?p:"?"));case 3:case"end":return t.stop()}}),t)}))),Yt.apply(this,arguments)}function jt(){return Xt.apply(this,arguments)}function Xt(){return(Xt=c(e(f).mark((function t(){var n,r;return e(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!N.disabled){t.next=2;break}return t.abrupt("return");case 2:return z.classList.remove("hidden","error","done"),z.textContent="Graphing...",t.next=6,B();case 6:return t.next=8,Ft();case 8:n=H.value,t.prev=9,r=q(n),yt="function"===r.type?r.f:function(){return r.f},Qt(mt,n),t.next=19;break;case 15:throw t.prev=15,t.t0=t.catch(9),Wt(t.t0),t.t0;case 19:case"end":return t.stop()}}),t,null,[[9,15]])})))).apply(this,arguments)}function Ft(){return Tt.apply(this,arguments)}function Tt(){return(Tt=c(e(f).mark((function t(){return e(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){requestAnimationFrame((function(){requestAnimationFrame((function(){return t()}))}))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Pt(t){return Bt.apply(this,arguments)}function Bt(){return(Bt=c(e(f).mark((function t(n){var r;return e(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={action:"init"},n.postMessage(r),t.abrupt("return",new Promise((function(t){n.onmessage=function(e){t()}})));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Qt(t,e){rt++,rt|=0;var n={action:"mainRequest",pev:Jt(e),cd:{width:T.width,height:T.height,center:[et.re,et.im],scale:ot},graphID:rt};t.postMessage(n)}function Jt(t){var e=I.simplify(t),n=!1;return"OperatorNode"!=e.type||"divide"!=e.fn||isNaN(+e.args[0])||(e.args.reverse(),e=I.simplify(e),n=!0),{fstr:e.toString(),inverse:n}}function Kt(t){return Zt.apply(this,arguments)}function Zt(){return(Zt=c(e(f).mark((function t(n){return e(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return z.textContent="Done in ".concat(n,"ms."),z.classList.add("done"),t.next=4,Ft();case 4:Gt();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Wt(t){var e=t instanceof ErrorEvent?t.message:t;z.classList.add("error"),z.textContent=String(e)}function Gt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;setTimeout((function(){z.classList.contains("done")&&(z.classList.remove("done"),z.classList.add("hidden"))}),t)}function Vt(t,e,n){t[e]!==n&&(t[e]=n)}function $t(t,e){t.classList.toggle("hidden",e),t instanceof HTMLButtonElement&&(t.disabled=e)}T.addEventListener("wheel",(function(t){if(t.preventDefault(),clearTimeout(Mt),Dt||(Dt=!0,J.prepare()),t.ctrlKey)at(t.clientX,t.clientY,t.deltaY),J.draw();else{var e=.5*t.deltaX,n=.5*t.deltaY,r=Ht.toComplexDisplace(e,n);nt(et.sub(r)),J.draw()}Ut(t),Mt=setTimeout((function(){jt(),J.release(),Dt=!1}),500)}),!1),T.addEventListener("mousemove",Ut),O.addEventListener("mousemove",Ut),document.addEventListener("click",Ut),window.addEventListener("resize",(function(t){void 0!==Ot&&clearTimeout(Ot),Ot=setTimeout(c(e(f).mark((function t(){return e(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,jt();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),200)})),document.querySelector("form#zoom-form").addEventListener("submit",(function(){U.checkValidity()&&it(2/+U.value)})),document.querySelectorAll("form.graph-submit").forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault(),jt()}))})),document.querySelectorAll("button.graph-submit").forEach((function(t){t.addEventListener("click",(function(){jt()}))})),Nt=Ht||(Ht={}),zt=function(t,e){var n=T.width,r=T.height,o=(0,l.default)(ft(),2),i=o[0],a=o[1],u=[(n-1)/2,-(r-1)/2],c=u[0],s=u[1];return(0,d.Complex)(t*i/c,e*a/s)},_t=function(t){var e=T.width,n=T.height,r=(0,l.default)(ft(),2),o=r[0],i=r[1],a=[(e-1)/2,-(n-1)/2],u=a[0],c=a[1];return[t.re*u/o,t.im*c/i]},Nt.toComplex=function(t,e){var n=[(T.width-1)/2,(T.height-1)/2],r=zt(t-n[0],e-n[1]);return et.add(r)},Nt.toComplexDisplace=zt,Nt.toCanvas=function(t){var e=[(T.width-1)/2,(T.height-1)/2],n=e[0],r=e[1],o=t.sub(et),i=(0,l.default)(_t(o),2);return[n+i[0],r+i[1]]},Nt.toCanvasDisplace=_t}();
//# sourceMappingURL=complexgrapher.2cd5a0d0.js.map
