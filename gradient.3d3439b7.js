const canvas=document.querySelector("canvas"),ctx=canvas.getContext("2d");let ipol="lin",ipolRadios=document.querySelectorAll("input[type=radio]"),coloradd=document.querySelector("#coloradd"),colorsWrapper=document.querySelector("#colors");function getColors(){return[...document.querySelectorAll("input[type=color]")].map((e=>e.value))}function rgb(e){return[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)))}function colorRMButtons(){return document.querySelectorAll(".colorrm")}function interpolate(e,t,o){return Math.hypot(e*Math.sqrt(1-o),t*Math.sqrt(o))}function colorDiv(e="#000000"){let t=document.createElement("div"),o=document.createElement("input");o.type="color",o.value=e,o.addEventListener("change",update);let r=document.createElement("button");return r.classList.add("colorrm"),r.textContent="x",r.addEventListener("click",(()=>{colorsWrapper.removeChild(r.parentElement);let e=colorRMButtons();if(e.length<3)for(let t of e)t.disabled=!0;update()})),t.appendChild(o),t.appendChild(r),t}function update(){let e=getColors(),t=e.length-1;switch(ipol){case"lin":let l=ctx.createLinearGradient(0,0,canvas.width,0);for(var[o,r]of e.entries())l.addColorStop(o/t,r);ctx.fillStyle=l;break;case"rms":let a;"OffscreenCanvas"in globalThis?a=new OffscreenCanvas(canvas.width,1):(a=document.createElement("canvas"),[a.width,a.height]=[canvas.width,1]);let n=a.getContext("2d"),c=n.createImageData(a.width,1),d=new Uint32Array(c.data.buffer),i=d.length-1;for(var o=0;o<d.length;o++){let r=o/i*t,[l,a]=[Math.floor(r),r%1],[n,c]=[e[l],e[l+1]??"#000000"].map((e=>rgb(e))),u=Array.from({length:3},((e,t)=>interpolate(n[t],c[t],a)));d[o]=-16777216|u[2]<<16|u[1]<<8|u[0]<<0}n.putImageData(c,0,0);let u=ctx.createPattern(a,"repeat-y");ctx.fillStyle=u}ctx.fillRect(0,0,canvas.width,canvas.height)}document.querySelectorAll("input[type=color]").forEach((e=>e.addEventListener("change",update))),ipolRadios.forEach((e=>e.addEventListener("change",(t=>{ipol=e.value,update()})))),coloradd.addEventListener("click",(()=>{let e=colorDiv();colorsWrapper.insertBefore(e,coloradd);let t=colorRMButtons();if(t.length>2)for(let e of t)e.disabled=!1;update()})),document.querySelectorAll(".colorrm").forEach((e=>e.addEventListener("click",(()=>{colorsWrapper.removeChild(e.parentElement);let t=colorRMButtons();if(t.length<3)for(let e of t)e.disabled=!0;update()})))),update();
//# sourceMappingURL=gradient.3d3439b7.js.map
